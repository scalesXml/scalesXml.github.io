<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scales\xml\impl\NameCreators.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scales.xml.impl

<span class="keyword">import</span> scales.xml.<span class="delimiter">{</span>QName, AttributeQName, UnprefixedQName, Namespace, NoNamespaceQName, XmlVersion<span class="delimiter">}</span>

<span class="keyword">import</span> scales.xml.parser.strategies.<span class="delimiter">{</span>MemoryOptimisationStrategy, OptimisationToken<span class="delimiter">}</span>

<span class="comment">/**
 * Given an optimisation strategy create QNames for elements and attributes.
 *
 * These are primarily of use from parsers and handle 0 length uris and qNames with &quot;:&quot; in them.
 */</span> 
<span class="keyword">object</span> <a title="scales.xml.impl.NameCreators.type" id="scales.xml.impl.NameCreators">NameCreators</a> <a href="#scales.xml.impl.NameCreators" title="scales.xml.impl.NameCreators.type" class="delimiter">{</a>

  <span class="comment">/** Elems can have any QName, attribs only prefixed or default */</span>
  <span class="keyword">def</span> <a title="[Token &lt;: scales.xml.parser.strategies.OptimisationToken](uri: String, localName: String, qName: String, strategy: scales.xml.parser.strategies.MemoryOptimisationStrategy[Token], token: Token)scales.xml.QName" id="scales.xml.impl.NameCreators.eqn">eqn</a><span class="delimiter">[</span><a title=" &lt;: scales.xml.parser.strategies.OptimisationToken" id="scales.xml.impl.NameCreators.eqn;Token">Token</a> &lt;: OptimisationToken<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="scales.xml.impl.NameCreators.eqn.uri">uri</a>: <span title="String">String</span>,
    <a title="String" id="scales.xml.impl.NameCreators.eqn.localName">localName</a>: <span title="String">String</span>,
    <a title="String" id="scales.xml.impl.NameCreators.eqn.qName">qName</a>: <span title="String">String</span>, <a title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]" id="scales.xml.impl.NameCreators.eqn.strategy">strategy</a> : <a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">MemoryOptimisationStrategy</a><span class="delimiter">[</span>Token<span class="delimiter">]</span>, <a title="Token" id="scales.xml.impl.NameCreators.eqn.token">token</a> : <a href="#scales.xml.impl.NameCreators.eqn;Token" title="Token">Token</a><span class="delimiter">)</span>: <a href="../QName.scala.html#scales.xml;QName" title="scales.xml.QName">QName</a> =
    <span title="scales.xml.QName" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.eqn.uri" title="String">uri</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// can only be in qName</span>
      <a href="#scales.xml.impl.NameCreators.eqn.strategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">strategy</a>.<a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.noNamespaceQName" title="(local: String, token: Token)scales.xml.NoNamespaceQName">noNamespaceQName</a><span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.eqn.qName" title="String">qName</a>, <a href="#scales.xml.impl.NameCreators.eqn.token" title="Token">token</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// might have a prefix</span>
      <span title="scales.xml.QName" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.eqn.qName" title="String">qName</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#scales.xml.impl.NameCreators.eqn.localName" title="String">localName</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// no prefix</span>
	<a href="#scales.xml.impl.NameCreators.eqn.strategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">strategy</a>.<a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.unprefixedQName" title="(local: String, uri: String, token: Token)scales.xml.UnprefixedQName">unprefixedQName</a><span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.eqn.localName" title="String">localName</a>, <a href="#scales.xml.impl.NameCreators.eqn.uri" title="String">uri</a>, <a href="#scales.xml.impl.NameCreators.eqn.token" title="Token">token</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="comment">// break up the prefix</span>
        <span class="keyword">val</span> <a title="Array[String]" id="scales.xml.impl.NameCreators.eqn.bits">bits</a> = <a href="#scales.xml.impl.NameCreators.eqn.qName" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">qName</a>.<span title="(separator: Char)Array[String]">split</span><span class="delimiter">(</span><span title="Char(':')" class="char">':'</span><span class="delimiter">)</span>
	
	<a href="#scales.xml.impl.NameCreators.eqn.strategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">strategy</a>.<a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.prefixedQName" title="(local: String, uri: String, prefix: String, token: Token)scales.xml.PrefixedQName">prefixedQName</a><span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.eqn.localName" title="String">localName</a>, <a href="#scales.xml.impl.NameCreators.eqn.uri" title="String">uri</a>, <a href="#scales.xml.impl.NameCreators.eqn.bits" title="(i: Int)String">bits</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#scales.xml.impl.NameCreators.eqn.token" title="Token">token</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="comment">/** attribs only prefixed or default */</span>
  <span class="keyword">def</span> <a title="[Token &lt;: scales.xml.parser.strategies.OptimisationToken](uri: String, localName: String, qName: String, strategy: scales.xml.parser.strategies.MemoryOptimisationStrategy[Token], token: Token)scales.xml.AttributeQName" id="scales.xml.impl.NameCreators.aqn">aqn</a><span class="delimiter">[</span><a title=" &lt;: scales.xml.parser.strategies.OptimisationToken" id="scales.xml.impl.NameCreators.aqn;Token">Token</a> &lt;: OptimisationToken<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="scales.xml.impl.NameCreators.aqn.uri">uri</a>: <span title="String">String</span>,
    <a title="String" id="scales.xml.impl.NameCreators.aqn.localName">localName</a>: <span title="String">String</span>,
    <a title="String" id="scales.xml.impl.NameCreators.aqn.qName">qName</a>: <span title="String">String</span>, <a title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]" id="scales.xml.impl.NameCreators.aqn.strategy">strategy</a> : <a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">MemoryOptimisationStrategy</a><span class="delimiter">[</span>Token<span class="delimiter">]</span>, <a title="Token" id="scales.xml.impl.NameCreators.aqn.token">token</a> : <a href="#scales.xml.impl.NameCreators.aqn;Token" title="Token">Token</a><span class="delimiter">)</span>: <a href="../../utils/EitherLike.scala.html#scales.utils;EitherLike" title="scales.xml.AttributeQName">AttributeQName</a> =
    <span title="scales.xml.AttributeQName" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.aqn.uri" title="String">uri</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// can only be in qName</span>
      <a href="#scales.xml.impl.NameCreators.aqn.strategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">strategy</a>.<a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.noNamespaceQName" title="(local: String, token: Token)scales.xml.NoNamespaceQName">noNamespaceQName</a><span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.aqn.qName" title="String">qName</a>, <a href="#scales.xml.impl.NameCreators.aqn.token" title="Token">token</a><span class="delimiter">)</span> <span class="comment">// Right</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// might have a prefix</span>
      <span title="scales.xml.AttributeQName" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.aqn.qName" title="String">qName</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#scales.xml.impl.NameCreators.aqn.localName" title="String">localName</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// no prefix</span>
        scales.utils.<a href="../../utils/package.scala.html#scales.utils.package.error" title="(str: String)Nothing">error</a><span class="delimiter">(</span><span title="String(&quot;Should not have an attribute with a unprefixed namspace&quot;)" class="string">&quot;Should not have an attribute with a unprefixed namspace&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="comment">// break up the prefix</span>
        <span class="keyword">val</span> <a title="Array[String]" id="scales.xml.impl.NameCreators.aqn.bits">bits</a> = <a href="#scales.xml.impl.NameCreators.aqn.qName" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">qName</a>.<span title="(separator: Char)Array[String]">split</span><span class="delimiter">(</span><span title="Char(':')" class="char">':'</span><span class="delimiter">)</span>
        <a href="#scales.xml.impl.NameCreators.aqn.strategy" title="scales.xml.parser.strategies.MemoryOptimisationStrategy[Token]">strategy</a>.<a href="../parser/strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.prefixedQName" title="(local: String, uri: String, prefix: String, token: Token)scales.xml.PrefixedQName">prefixedQName</a><span class="delimiter">(</span><a href="#scales.xml.impl.NameCreators.aqn.localName" title="String">localName</a>, <a href="#scales.xml.impl.NameCreators.aqn.uri" title="String">uri</a>,<a href="#scales.xml.impl.NameCreators.aqn.bits" title="(i: Int)String">bits</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#scales.xml.impl.NameCreators.aqn.token" title="Token">token</a><span class="delimiter">)</span> <span class="comment">// Left</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>


<span title="AnyRef" class="keyword">trait</span> <a title="trait QNameImplicits extends AnyRef" id="scales.xml.impl;QNameImplicits">QNameImplicits</a> <span title="Unit" class="delimiter">{</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scales.xml.impl.QNameImplicits.stringToNoNamespace : (localOnly: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName" id="scales.xml.impl;QNameImplicits.stringToNoNamespace">stringToNoNamespace</a><span class="delimiter">(</span> <a title="String" id="scales.xml.impl;QNameImplicits.stringToNoNamespace.localOnly">localOnly</a> : <span title="String">String</span> <span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scales.xml.XmlVersion" id="scales.xml.impl;QNameImplicits.stringToNoNamespace.ver">ver</a> : <a href="../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a>, <a title="scales.xml.impl.FromParser" id="scales.xml.impl;QNameImplicits.stringToNoNamespace.fromParser">fromParser</a>: <a href="FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a><span class="delimiter">)</span> = <a href="../QName.scala.html#scales.xml.NoNamespaceQName.apply" title="(locali: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName">NoNamespaceQName</a><a href="#scales.xml.impl;QNameImplicits.stringToNoNamespace.ver" title="scales.xml.XmlVersion" class="delimiter">(</a><a href="#scales.xml.impl;QNameImplicits.stringToNoNamespace.localOnly" title="String">localOnly</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scales.xml.impl.QNameImplicits.localStringToNSBuilder : (local: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.impl.StringToNSBuilder" id="scales.xml.impl;QNameImplicits.localStringToNSBuilder">localStringToNSBuilder</a><span class="delimiter">(</span> <a title="String" id="scales.xml.impl;QNameImplicits.localStringToNSBuilder.local">local</a> : <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scales.xml.XmlVersion" id="scales.xml.impl;QNameImplicits.localStringToNSBuilder.ver">ver</a> : <a href="../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a>, <a title="scales.xml.impl.FromParser" id="scales.xml.impl;QNameImplicits.localStringToNSBuilder.fromParser">fromParser</a>: <a href="FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a><span class="delimiter">)</span> = <a href="#scales.xml.impl;QNameImplicits.localStringToNSBuilder.ver" title="scales.xml.impl.StringToNSBuilder" class="keyword">new</a> <a href="#scales.xml.impl;StringToNSBuilder" title="scales.xml.impl.StringToNSBuilder">StringToNSBuilder</a><span class="delimiter">(</span><a href="#scales.xml.impl;QNameImplicits.localStringToNSBuilder.local" title="String">local</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Pimps a string for namespace handling
 */</span> 
<span title="AnyRef" class="keyword">class</span> <a title="class StringToNSBuilder extends AnyRef" id="scales.xml.impl;StringToNSBuilder">StringToNSBuilder</a><a href="#scales.xml.impl;StringToNSBuilder" title="scales.xml.impl.StringToNSBuilder" class="delimiter">(</a><a title="String" id="scales.xml.impl;StringToNSBuilder.local">local</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scales.xml.XmlVersion" id="scales.xml.impl;StringToNSBuilder.ver">ver</a> : <a href="../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a>, <a title="scales.xml.impl.FromParser" id="scales.xml.impl;StringToNSBuilder.fromParser">fromParser</a>: <a href="FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/**
   * ns :: localname pimp.
   */</span> 
  <span class="keyword">def</span> <a title="(namespace: String)scales.xml.UnprefixedQName" id="scales.xml.impl;StringToNSBuilder.::">::</a><span class="delimiter">(</span> <a title="String" id="scales.xml.impl;StringToNSBuilder.::.namespace">namespace</a> : <span title="String">String</span> <span class="delimiter">)</span> = <span title="apply extends AnyRef with scales.xml.UnprefixedQName" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#scales.xml.impl;StringToNSBuilder.::.namespace" title="String">namespace</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#scales.xml.impl;StringToNSBuilder.::.namespace" title="String">namespace</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="String(&quot;Namespace should not be non empty or null&quot;)" class="string">&quot;Namespace should not be non empty or null&quot;</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../QName.scala.html#scales.xml.UnprefixedQName.apply" title="(locali: String, namespacei: scales.xml.Namespace)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.UnprefixedQName">UnprefixedQName</a><a href="#scales.xml.impl;StringToNSBuilder.ver" title="scales.xml.XmlVersion" class="delimiter">(</a><a href="#scales.xml.impl;StringToNSBuilder.local" title="String">local</a>, <a href="../Namespaces.scala.html#scales.xml.Namespace.apply" title="(validUri: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.Namespace">Namespace</a><a href="#scales.xml.impl;StringToNSBuilder.ver" title="scales.xml.XmlVersion" class="delimiter">(</a><a href="#scales.xml.impl;StringToNSBuilder.::.namespace" title="String">namespace</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * When there are other implicits after the string conversion gold add an &quot;l&quot; for local only 
   */</span>
  <span class="keyword">def</span> <a title="(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName" id="scales.xml.impl;StringToNSBuilder.l">l</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scales.xml.XmlVersion" id="scales.xml.impl;StringToNSBuilder.l.ver">ver</a> : <a href="../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a>, <a title="scales.xml.impl.FromParser" id="scales.xml.impl;StringToNSBuilder.l.fromParser">fromParser</a> : <a href="FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a><span class="delimiter">)</span> = <a href="../QName.scala.html#scales.xml.NoNamespaceQName.apply" title="(locali: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName">NoNamespaceQName</a><a href="#scales.xml.impl;StringToNSBuilder.l.ver" title="scales.xml.XmlVersion" class="delimiter">(</a><a href="#scales.xml.impl;StringToNSBuilder.local" title="String">local</a><span class="delimiter">)</span>

  <span class="comment">/**
   * When there are other implicits after the string conversion gold add an &quot;localOnly&quot; or &quot;l&quot; for local only 
   */</span>
  <span class="keyword">def</span> <a title="(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName" id="scales.xml.impl;StringToNSBuilder.localOnly">localOnly</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scales.xml.XmlVersion" id="scales.xml.impl;StringToNSBuilder.localOnly.ver">ver</a> : <a href="../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a>, <a title="scales.xml.impl.FromParser" id="scales.xml.impl;StringToNSBuilder.localOnly.fromParser">fromParser</a> : <a href="FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a><span class="delimiter">)</span> = <a href="../QName.scala.html#scales.xml.NoNamespaceQName.apply" title="(locali: String)(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)scales.xml.NoNamespaceQName">NoNamespaceQName</a><a href="#scales.xml.impl;StringToNSBuilder.localOnly.ver" title="scales.xml.XmlVersion" class="delimiter">(</a><a href="#scales.xml.impl;StringToNSBuilder.local" title="String">local</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
