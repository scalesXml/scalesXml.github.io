<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scales\xml\parser\sax\Handler.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scales.xml.parser.sax

<span class="keyword">import</span> org.xml.sax.Locator
<span class="keyword">import</span> org.xml.sax.ext.Locator2

<span class="keyword">import</span> scales.xml._
<span class="keyword">import</span> parser._
<span class="keyword">import</span> scales.xml.parser.strategies.<span class="delimiter">{</span>PathOptimisationStrategy, OptimisationToken<span class="delimiter">}</span>

<span class="keyword">import</span> scales.xml.impl.<span class="delimiter">{</span>NotFromParser, IsFromParser, FromParser<span class="delimiter">}</span>

<span class="keyword">import</span> impl.<span class="delimiter">{</span>NameCreators, TreeProxies<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class Handler[Token &lt;: scales.xml.parser.strategies.OptimisationToken] extends org.xml.sax.ext.DefaultHandler2" id="scales.xml.parser.sax;Handler">Handler</a><span class="delimiter">[</span><a title=" &lt;: scales.xml.parser.strategies.OptimisationToken" id="scales.xml.parser.sax;Handler;Token">Token</a> &lt;: OptimisationToken<span class="delimiter">]</span><a href="#scales.xml.parser.sax;Handler" title="scales.xml.parser.sax.Handler[Token]" class="delimiter">(</a><a title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]" id="scales.xml.parser.sax;Handler.strategy">strategy</a> : <a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;PathOptimisationStrategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">PathOptimisationStrategy</a><span class="delimiter">[</span>Token<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scales.xml.XmlVersion" id="scales.xml.parser.sax;Handler.defaultVersion">defaultVersion</a> : <a href="../../Namespaces.scala.html#scales.xml;XmlVersion" title="scales.xml.XmlVersion">XmlVersion</a><span class="delimiter">)</span> <span class="keyword">extends</span> org.xml.sax.ext.<span title="org.xml.sax.ext.DefaultHandler2">DefaultHandler2</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> scales.xml.<a href="../../ScalesXml.scala.html#scales.xml.ScalesXml" title="scales.xml.ScalesXml.type">ScalesXml</a>.xmlCBF

  <span class="keyword">import</span> scales.utils.<span class="delimiter">{</span>noPath, top, ScalesUtils <span class="delimiter">}</span>
  <span class="keyword">import</span> scales.utils.collection.path.Path
  <span class="keyword">import</span> org.xml.sax._
  <span class="keyword">import</span> scala.collection.immutable.Stack
  <span class="keyword">import</span> <a href="../../../utils/ScalesUtils.scala.html#scales.utils.ScalesUtils" title="scales.utils.ScalesUtils.type">ScalesUtils</a>._

  <span class="keyword">import</span> <a href="../../impl/NameCreators.scala.html#scales.xml.impl.NameCreators" title="scales.xml.impl.NameCreators.type">NameCreators</a>._
  
  <span class="comment">//    import ScalesXml.toQName // Note we aren't validating the names here anyway so we don't need to use the correct xml version, future version may double check perhaps?</span>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="scales.xml.impl.FromParser" id="scales.xml.parser.sax;Handler.weAreInAParser">weAreInAParser</a> : <a href="../../impl/FromParser.scala.html#scales.xml.impl;FromParser" title="scales.xml.impl.FromParser">FromParser</a> = <a href="../../impl/FromParser.scala.html#scales.xml.impl.IsFromParser" title="scales.xml.impl.IsFromParser.type">IsFromParser</a>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="Token" id="scales.xml.parser.sax;Handler.token">token</a> : <a href="#scales.xml.parser.sax;Handler;Token" title="Token">Token</a> = <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.createToken" title="(implicit ver: scales.xml.XmlVersion, implicit fromParser: scales.xml.impl.FromParser)Token">createToken</a>

  <span class="comment">// only trees have kids, and we only need to keep the parent</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="scales.xml.impl.TreeProxies" id="scales.xml.parser.sax;Handler.buf">buf</a> = <span title="scales.xml.impl.TreeProxies" class="keyword">new</span> <a href="../../impl/TreeProxies.scala.html#scales.xml.impl;TreeProxies" title="scales.xml.impl.TreeProxies">TreeProxies</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; scales.xml.impl.TreeProxies" id="scales.xml.parser.sax;Handler.getBuf">getBuf</a> = <a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="scales.xml.parser.sax;Handler.isCData">isCData</a> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="comment">// declarations on this element</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="scala.collection.immutable.Map[String,String]" id="scales.xml.parser.sax;Handler.nsDeclarations">nsDeclarations</a> = <a href="../../impl/XmlTypesDefaults.scala.html#scales.xml.impl;XmlTypes.emptyNamespaces" title="=&gt; scala.collection.immutable.Map[String,String]">emptyNamespaces</a>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="scales.xml.Prolog" id="scales.xml.parser.sax;Handler.prolog">prolog</a> = <a href="../../XmlTypes.scala.html#scales.xml;Prolog" title="(decl: scales.xml.Declaration, misc: scales.xml.Miscs, dtd: Option[scales.xml.DTD])scales.xml.Prolog">Prolog</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="scales.xml.EndMisc" id="scales.xml.parser.sax;Handler.end">end</a> = <a href="../../XmlTypes.scala.html#scales.xml;EndMisc" title="(misc: scales.xml.Miscs)scales.xml.EndMisc">EndMisc</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; scales.xml.Prolog" id="scales.xml.parser.sax;Handler.getProlog">getProlog</a> = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a>
  <span class="keyword">def</span> <a title="=&gt; scales.xml.EndMisc" id="scales.xml.parser.sax;Handler.getEnd">getEnd</a> = <a href="#scales.xml.parser.sax;Handler.end" title="scales.xml.EndMisc">end</a>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="org.xml.sax.Locator" id="scales.xml.parser.sax;Handler.locator">locator</a> : <span title="org.xml.sax.Locator">Locator</span> = _
  
  <span class="comment">// used for judging PI or Comments</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="scales.xml.parser.sax;Handler.inprolog">inprolog</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">def</span> <a title="(what: String)Unit" id="scales.xml.parser.sax;Handler.checkit">checkit</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.checkit.what">what</a>: <span title="String">String</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: String, publicId: String, systemId: String)Unit" id="scales.xml.parser.sax;Handler.startDTD">startDTD</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.startDTD.name">name</a> : <span title="String">String</span>, <a title="String" id="scales.xml.parser.sax;Handler.startDTD.publicId">publicId</a> : <span title="String">String</span>, <a title="String" id="scales.xml.parser.sax;Handler.startDTD.systemId">systemId</a> : <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a> = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog" id="scales.xml.parser.sax;Handler.startDTD.qual$1">prolog</a>.<a href="../../XmlTypes.scala.html#scales.xml;Prolog.copy$default$1" title="scales.xml.Declaration" id="scales.xml.parser.sax;Handler.startDTD.x$3">copy</a><span class="delimiter">(</span>dtd = <span title="(x: scales.xml.DTD)Some[scales.xml.DTD]">Some</span><a title="Some[scales.xml.DTD]" id="scales.xml.parser.sax;Handler.startDTD.x$1" class="delimiter">(</a><a href="../../XmlTypes.scala.html#scales.xml;DTD" title="(name: String, publicId: String, systemId: String)scales.xml.DTD">DTD</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startDTD.name" title="String">name</a>, <a href="#scales.xml.parser.sax;Handler.startDTD.publicId" title="String">publicId</a>, <a href="#scales.xml.parser.sax;Handler.startDTD.systemId" title="String">systemId</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(target: String, data: String)Unit" id="scales.xml.parser.sax;Handler.processingInstruction">processingInstruction</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.processingInstruction.target">target</a> : <span title="String">String</span>, <a title="String" id="scales.xml.parser.sax;Handler.processingInstruction.data">data</a> : <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="apply extends AnyRef with scales.xml.PI" id="scales.xml.parser.sax;Handler.processingInstruction.pi">pi</a> = <a href="../../XmlTypes.scala.html#scales.xml.PI.apply" title="(targeti: String, valuei: String)(implicit fromParser: scales.xml.impl.FromParser)scales.xml.PI">PI</a><a href="#scales.xml.parser.sax;Handler.weAreInAParser" title="scales.xml.impl.FromParser" class="delimiter">(</a><a href="#scales.xml.parser.sax;Handler.processingInstruction.target" title="String">target</a>, <a href="#scales.xml.parser.sax;Handler.processingInstruction.data" title="String">data</a><span class="delimiter">)</span>
    <a href="#scales.xml.parser.sax;Handler.addMisc" title="(miscItem: scales.xml.Misc)Unit">addMisc</a><span class="delimiter">(</span><span title="(b: scales.xml.PI)scala.util.Right[Nothing,scales.xml.PI]">Right</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.processingInstruction.pi" title="apply extends AnyRef with scales.xml.PI">pi</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> 

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(prefix: String, uri: String)Unit" id="scales.xml.parser.sax;Handler.startPrefixMapping">startPrefixMapping</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.startPrefixMapping.prefix">prefix</a>: <span title="String">String</span>, <a title="String" id="scales.xml.parser.sax;Handler.startPrefixMapping.uri">uri</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#scales.xml.parser.sax;Handler.nsDeclarations" title="scala.collection.immutable.Map[String,String]">nsDeclarations</a> <span title="(kv: (String, String))scala.collection.immutable.Map[String,String]">+=</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startPrefixMapping.prefix" title="(x: String)ArrowAssoc[String]">prefix</a> <span title="(y: String)(String, String)">-&gt;</span> <a href="#scales.xml.parser.sax;Handler.startPrefixMapping.uri" title="String">uri</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(loc: org.xml.sax.Locator)Unit" id="scales.xml.parser.sax;Handler.setDocumentLocator">setDocumentLocator</a><span class="delimiter">(</span> <a title="org.xml.sax.Locator" id="scales.xml.parser.sax;Handler.setDocumentLocator.loc">loc</a> : <span title="org.xml.sax.Locator">Locator</span> <span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#scales.xml.parser.sax;Handler.locator" title="org.xml.sax.Locator">locator</a> = <a href="#scales.xml.parser.sax;Handler.setDocumentLocator.loc" title="org.xml.sax.Locator">loc</a>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(uri: String, localName: String, qName: String, attributes: org.xml.sax.Attributes)Unit" id="scales.xml.parser.sax;Handler.startElement">startElement</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.startElement.uri">uri</a>: <span title="String">String</span>,
			    <a title="String" id="scales.xml.parser.sax;Handler.startElement.localName">localName</a>: <span title="String">String</span>,
			    <a title="String" id="scales.xml.parser.sax;Handler.startElement.qName">qName</a>: <span title="String">String</span>,
			    <a title="org.xml.sax.Attributes" id="scales.xml.parser.sax;Handler.startElement.attributes">attributes</a>: org.xml.sax.<span title="org.xml.sax.Attributes">Attributes</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.inprolog" title="Boolean">inprolog</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.locator" title="org.xml.sax.Locator">locator</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="org.xml.sax.ext.Locator2">Locator2</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
	<span class="keyword">val</span> <a title="org.xml.sax.ext.Locator2" id="scales.xml.parser.sax;Handler.startElement.loc2">loc2</a> = <a href="#scales.xml.parser.sax;Handler.locator" title="org.xml.sax.Locator">locator</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.xml.sax.ext.Locator2" class="delimiter">[</span><span title="org.xml.sax.ext.Locator2">Locator2</span><span class="delimiter">]</span>
	<a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a> = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog" id="scales.xml.parser.sax;Handler.startElement.qual$2">prolog</a>.<a href="../../XmlTypes.scala.html#scales.xml;Prolog.copy$default$2" title="scales.xml.Miscs" id="scales.xml.parser.sax;Handler.startElement.x$9">copy</a><span class="delimiter">(</span> decl = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a>.<a href="../../XmlTypes.scala.html#scales.xml;Prolog.decl" title="scales.xml.Declaration" id="scales.xml.parser.sax;Handler.startElement.x$7.qual$3">decl</a>.<a href="../../XmlTypes.scala.html#scales.xml;Declaration.copy$default$1" title="scales.xml.XmlVersion" id="scales.xml.parser.sax;Handler.startElement.x$7.x$6">copy</a><a title="scales.xml.Declaration" id="scales.xml.parser.sax;Handler.startElement.x$7" class="delimiter">(</a>encoding = <span class="delimiter">(</span>
	  <a title="java.nio.charset.Charset" id="scales.xml.parser.sax;Handler.startElement.x$7.x$4" class="keyword">if</a> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.loc2" title="org.xml.sax.ext.Locator2">loc2</a>.<span title="()String">getEncoding</span> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
	    java.nio.charset.<span title="java.nio.charset.Charset.type">Charset</span>.<span title="(x$1: String)java.nio.charset.Charset">forName</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.loc2" title="org.xml.sax.ext.Locator2">loc2</a>.<span title="()String">getEncoding</span><span class="delimiter">)</span>
	  <span class="delimiter">}</span> <span class="keyword">else</span> scales.utils.<a href="../../../utils/package.scala.html#scales.utils.package.defaultCharset" title="=&gt; java.nio.charset.Charset">defaultCharset</a>
	<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>	  
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#scales.xml.parser.sax;Handler.inprolog" title="Boolean">inprolog</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">var</span> <a title="Int" id="scales.xml.parser.sax;Handler.startElement.i">i</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="Int" id="scales.xml.parser.sax;Handler.startElement.length">length</a> = <a href="#scales.xml.parser.sax;Handler.startElement.attributes" title="org.xml.sax.Attributes">attributes</a>.<span title="()Int">getLength</span>
    <span class="keyword">val</span> <a title="Array[scales.xml.Attribute]" id="scales.xml.parser.sax;Handler.startElement.attrs">attrs</a> = <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.attributeArray" title="(newSize: Int, token: Token)Array[scales.xml.Attribute]">attributeArray</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.length" title="Int">length</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#scales.xml.parser.sax;Handler.startElement.length" title="Int">length</a><span class="delimiter">)</span> <a href="#scales.xml.parser.sax;Handler.startElement.while$1" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a title="scales.xml.AttributeQName" id="scales.xml.parser.sax;Handler.startElement.qname">qname</a> = <a href="../../impl/NameCreators.scala.html#scales.xml.impl.NameCreators.aqn" title="(uri: String, localName: String, qName: String, strategy: scales.xml.parser.strategies.MemoryOptimisationStrategy[Token], token: Token)scales.xml.AttributeQName">aqn</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.attributes" title="org.xml.sax.Attributes">attributes</a>.<span title="(x$1: Int)String">getURI</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a><span class="delimiter">)</span>, <a href="#scales.xml.parser.sax;Handler.startElement.attributes" title="org.xml.sax.Attributes">attributes</a>.<span title="(x$1: Int)String">getLocalName</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a><span class="delimiter">)</span>, <a href="#scales.xml.parser.sax;Handler.startElement.attributes" title="org.xml.sax.Attributes">attributes</a>.<span title="(x$1: Int)String">getQName</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a><span class="delimiter">)</span>, <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>
      <a href="#scales.xml.parser.sax;Handler.startElement.attrs" title="Array[scales.xml.Attribute]">attrs</a>.<span title="(i: Int, x: scales.xml.Attribute)Unit">update</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a>,
		   <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.attribute" title="(qname: scales.xml.AttributeQName, value: String, token: Token)scales.xml.Attribute">attribute</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.qname" title="scales.xml.AttributeQName">qname</a>, 
			 <a href="#scales.xml.parser.sax;Handler.startElement.attributes" title="org.xml.sax.Attributes">attributes</a>.<span title="(x$1: Int)String">getValue</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a><span class="delimiter">)</span>, 
			 <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>
		 <span class="delimiter">)</span>

      <a href="#scales.xml.parser.sax;Handler.startElement.i" title="Int">i</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>

    <span class="comment">// copy the created attribs</span>
    <span class="keyword">val</span> <a title="scales.utils.collection.ArraySet[scales.xml.Attribute]" id="scales.xml.parser.sax;Handler.startElement.attribs">attribs</a> = scales.xml.impl.<a href="../../impl/AttributeSetImpl.scala.html#scales.xml.impl.AttributeSet" title="scales.xml.impl.AttributeSet.type">AttributeSet</a>.<a href="../../impl/AttributeSetImpl.scala.html#scales.xml.impl.AttributeSet.unsafe" title="(ar: Array[scales.xml.Attribute], len: Int)scales.utils.collection.ArraySet[scales.xml.Attribute]">unsafe</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.attrs" title="Array[scales.xml.Attribute]">attrs</a>, <a href="#scales.xml.parser.sax;Handler.startElement.length" title="Int">length</a><span class="delimiter">)</span>
    
    <span class="comment">// use the current nsMap</span>
    <span class="keyword">val</span> <a title="scales.xml.Elem" id="scales.xml.parser.sax;Handler.startElement.elem">elem</a> = <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;MemoryOptimisationStrategy.elem" title="(name: scales.xml.QName, attributes: scales.xml.Attributes, namespaces: Map[String,String], token: Token)scales.xml.Elem">elem</a><span class="delimiter">(</span>
      <a href="../../impl/NameCreators.scala.html#scales.xml.impl.NameCreators.eqn" title="(uri: String, localName: String, qName: String, strategy: scales.xml.parser.strategies.MemoryOptimisationStrategy[Token], token: Token)scales.xml.QName">eqn</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.startElement.uri" title="String">uri</a>, <a href="#scales.xml.parser.sax;Handler.startElement.localName" title="String">localName</a>, <a href="#scales.xml.parser.sax;Handler.startElement.qName" title="String">qName</a>, <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>
      , <a href="#scales.xml.parser.sax;Handler.startElement.attribs" title="scales.utils.collection.ArraySet[scales.xml.Attribute]">attribs</a>, <a href="#scales.xml.parser.sax;Handler.nsDeclarations" title="scala.collection.immutable.Map[String,String]">nsDeclarations</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>

    <span class="comment">// reset the map</span>
    <a href="#scales.xml.parser.sax;Handler.nsDeclarations" title="scala.collection.immutable.Map[String,String]">nsDeclarations</a> = <a href="../../impl/XmlTypesDefaults.scala.html#scales.xml.impl;XmlTypes.emptyNamespaces" title="=&gt; scala.collection.immutable.Map[String,String]">emptyNamespaces</a>

    <span class="comment">// give it a fake mutable default to work with</span>
    <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;PathOptimisationStrategy.beginSubTree" title="(stack: scales.xml.impl.TreeProxies, elem: scales.xml.Elem, token: Token)Unit">beginSubTree</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>, <a href="#scales.xml.parser.sax;Handler.startElement.elem" title="scales.xml.Elem">elem</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(uri: String, localName: String, qName: String)Unit" id="scales.xml.parser.sax;Handler.endElement">endElement</a><span class="delimiter">(</span><a title="String" id="scales.xml.parser.sax;Handler.endElement.uri">uri</a>: <span title="String">String</span>,
			  <a title="String" id="scales.xml.parser.sax;Handler.endElement.localName">localName</a>: <span title="String">String</span>,
			  <a title="String" id="scales.xml.parser.sax;Handler.endElement.qName">qName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>

    <span class="comment">// pop it and we are now with the correct parent</span>
    <span class="comment">// let the strategy decide what actually happens</span>
    <a href="#scales.xml.parser.sax;Handler.strategy" title="scales.xml.parser.strategies.PathOptimisationStrategy[Token]">strategy</a>.<a href="../strategies/OptimisingStrategies.scala.html#scales.xml.parser.strategies;PathOptimisationStrategy.elementEnd" title="(xml: scales.xml.impl.TreeProxies, token: Token)Unit">elementEnd</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>, <a href="#scales.xml.parser.sax;Handler.token" title="Token">token</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ch: Array[Char], offset: Int, length: Int)Unit" id="scales.xml.parser.sax;Handler.comment">comment</a><span class="delimiter">(</span><a title="Array[Char]" id="scales.xml.parser.sax;Handler.comment.ch">ch</a>: <span title="Array[Char]">Array</span><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="Int" id="scales.xml.parser.sax;Handler.comment.offset">offset</a>: <span title="Int">Int</span>, <a title="Int" id="scales.xml.parser.sax;Handler.comment.length">length</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="scales.xml.parser.sax;Handler.comment.text">text</a> = <span title="(x$1: Array[Char], x$2: Int, x$3: Int)String" class="keyword">new</span> <span title="String">String</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.comment.ch" title="Array[Char]">ch</a>, <a href="#scales.xml.parser.sax;Handler.comment.offset" title="Int">offset</a>, <a href="#scales.xml.parser.sax;Handler.comment.length" title="Int">length</a><span class="delimiter">)</span>

    <a href="#scales.xml.parser.sax;Handler.addMisc" title="(miscItem: scales.xml.Misc)Unit">addMisc</a><span class="delimiter">(</span> <span title="(a: scales.xml.Comment)scala.util.Left[scales.xml.Comment,Nothing]">Left</span><span class="delimiter">(</span><a href="../../XmlTypes.scala.html#scales.xml.Comment.apply" title="(valuei: String)(implicit fromParser: scales.xml.impl.FromParser)scales.xml.Comment">Comment</a><a href="#scales.xml.parser.sax;Handler.weAreInAParser" title="scales.xml.impl.FromParser" class="delimiter">(</a><a href="#scales.xml.parser.sax;Handler.comment.text" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">)</span>      
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(miscItem: scales.xml.Misc)Unit" id="scales.xml.parser.sax;Handler.addMisc">addMisc</a><span class="delimiter">(</span> <a title="scales.xml.Misc" id="scales.xml.parser.sax;Handler.addMisc.miscItem">miscItem</a> : <span title="scales.xml.Misc">Misc</span> <span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.inprolog" title="Boolean">inprolog</a><span class="delimiter">)</span> 
      <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a> = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog" id="scales.xml.parser.sax;Handler.addMisc.qual$4">prolog</a>.<a href="../../XmlTypes.scala.html#scales.xml;Prolog.copy$default$1" title="scales.xml.Declaration" id="scales.xml.parser.sax;Handler.addMisc.x$12">copy</a><span class="delimiter">(</span>misc = <a href="#scales.xml.parser.sax;Handler.prolog" title="scales.xml.Prolog">prolog</a>.<a href="../../XmlTypes.scala.html#scales.xml;Prolog.misc" title="=&gt; scales.xml.Miscs">misc</a> <a title="scales.xml.Miscs" id="scales.xml.parser.sax;Handler.addMisc.x$10">:+</a> <a href="#scales.xml.parser.sax;Handler.addMisc.miscItem" title="scales.xml.Misc">miscItem</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// need to tell if its finished the root elem or not</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>.<a href="../../impl/TreeProxies.scala.html#scales.xml.impl;TreeProxies.depth" title="=&gt; Int">depth</a> <span title="(x: Int)Boolean">==</span> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
	<a href="#scales.xml.parser.sax;Handler.end" title="scales.xml.EndMisc">end</a> = <a href="#scales.xml.parser.sax;Handler.end" title="scales.xml.EndMisc">end</a>.<a href="../../XmlTypes.scala.html#scales.xml;EndMisc.copy" title="(misc: scales.xml.Miscs)scales.xml.EndMisc">copy</a><span class="delimiter">(</span> misc = <a href="#scales.xml.parser.sax;Handler.end" title="scales.xml.EndMisc">end</a>.<a href="../../XmlTypes.scala.html#scales.xml;EndMisc.misc" title="=&gt; scales.xml.Miscs">misc</a> <span title="(elem: scales.xml.Misc)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scales.xml.Misc],scales.xml.Misc,scales.xml.Miscs])scales.xml.Miscs">:+</span> <a href="#scales.xml.parser.sax;Handler.addMisc.miscItem" title="scales.xml.Misc">miscItem</a><span class="delimiter">)</span>
      <span class="keyword">else</span>
	<span class="comment">// add it like a normal child</span>
	<a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>.<a href="../../impl/TreeProxies.scala.html#scales.xml.impl;TreeProxies.addChild" title="(i: scales.xml.XmlItem)Unit">addChild</a><span class="delimiter">(</span> <a href="#scales.xml.parser.sax;Handler.addMisc.miscItem" title="scales.xml.Misc">miscItem</a>.<span title="[X](fa: scales.xml.Comment =&gt; X, fb: scales.xml.PI =&gt; X)X">fold</span><span title="(fa: scales.xml.Comment =&gt; scales.xml.XmlItem, fb: scales.xml.PI =&gt; scales.xml.XmlItem)scales.xml.XmlItem" class="delimiter">[</span><a href="../../XmlTypes.scala.html#scales.xml;XmlItem" title="scales.xml.XmlItem">XmlItem</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scales.xml.Comment" id="scales.xml.parser.sax;Handler.addMisc.$anonfun.x">x</a>=&gt;<a href="#scales.xml.parser.sax;Handler.addMisc.$anonfun.x" title="scales.xml.Comment">x</a>, <a title="scales.xml.PI" id="scales.xml.parser.sax;Handler.addMisc.$anonfun.y">y</a>=&gt;<a href="#scales.xml.parser.sax;Handler.addMisc.$anonfun.y" title="scales.xml.PI">y</a><span class="delimiter">)</span><span class="delimiter">)</span> 
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(ch: Array[Char], offset: Int, length: Int)Unit" id="scales.xml.parser.sax;Handler.characters">characters</a><span class="delimiter">(</span><a title="Array[Char]" id="scales.xml.parser.sax;Handler.characters.ch">ch</a>: <span title="Array[Char]">Array</span><span class="delimiter">[</span>Char<span class="delimiter">]</span>, <a title="Int" id="scales.xml.parser.sax;Handler.characters.offset">offset</a>: <span title="Int">Int</span>, <a title="Int" id="scales.xml.parser.sax;Handler.characters.length">length</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="scales.xml.parser.sax;Handler.characters.text">text</a> = <span title="(x$1: Array[Char], x$2: Int, x$3: Int)String" class="keyword">new</span> <span title="String">String</span><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.characters.ch" title="Array[Char]">ch</a>, <a href="#scales.xml.parser.sax;Handler.characters.offset" title="Int">offset</a>, <a href="#scales.xml.parser.sax;Handler.characters.length" title="Int">length</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scales.xml.XmlItem" id="scales.xml.parser.sax;Handler.characters.child">child</a>: <a href="../../XmlTypes.scala.html#scales.xml;XmlItem" title="scales.xml.XmlItem">XmlItem</a> = <span title="scales.xml.XmlItem" class="keyword">if</span> <span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.isCData" title="Boolean">isCData</a><span class="delimiter">)</span> <a href="../../XmlTypes.scala.html#scales.xml.CData.apply" title="(valuei: String)(implicit fromParser: scales.xml.impl.FromParser)scales.xml.CData">CData</a><a href="#scales.xml.parser.sax;Handler.weAreInAParser" title="scales.xml.impl.FromParser" class="delimiter">(</a><a href="#scales.xml.parser.sax;Handler.characters.text" title="String">text</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../../XmlTypes.scala.html#scales.xml;Text" title="(value: String)scales.xml.Text">Text</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.characters.text" title="String">text</a><span class="delimiter">)</span>

    <span class="comment">// append as child</span>
    <a href="#scales.xml.parser.sax;Handler.buf" title="scales.xml.impl.TreeProxies">buf</a>.<a href="../../impl/TreeProxies.scala.html#scales.xml.impl;TreeProxies.addChild" title="(i: scales.xml.XmlItem)Unit">addChild</a><span class="delimiter">(</span><a href="#scales.xml.parser.sax;Handler.characters.child" title="scales.xml.XmlItem">child</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="scales.xml.parser.sax;Handler.startCDATA">startCDATA</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#scales.xml.parser.sax;Handler.isCData" title="Boolean">isCData</a> = <span title="Boolean(true)" class="keyword">true</span>; <span class="delimiter">}</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="scales.xml.parser.sax;Handler.endCDATA">endCDATA</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#scales.xml.parser.sax;Handler.isCData" title="Boolean">isCData</a> = <span title="Boolean(false)" class="keyword">false</span>; <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>
