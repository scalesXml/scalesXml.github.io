<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scales\utils\ImmutableArray.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    
<style id="linesStyle">
.lineHighlight {
  background-color: #a5a5a5;
}
</style>
<script type="text/javascript">
function selectedLine() {
    var loca = /^.*#l(.*)/.exec(location.href);
    return loca ? loca[1] : '0';
}

function highlightLine(ln){
  $('#l'+ln).toggleClass('lineHighlight');
}

function gotoLine(ln){
  $('#l'+ln).focus();
}

$(function(){
  var line = selectedLine();
  if (line != '0') highlightLine(line)
});
</script></head>
    <body>
        <pre>
<!-- SXR_LINES --><a href="l1"></a><span id="l1"><span class="keyword">package</span> scales.utils</span>
<a href="l2"></a><span id="l2"></span>
<a href="l3"></a><span id="l3"><span class="keyword">import</span> collection.<span class="delimiter">{</span>IndexedSeqOptimized, IndexedSeqLike, IndexedSeq<span class="delimiter">}</span></span>
<a href="l4"></a><span id="l4"><span class="keyword">import</span> collection.mutable.Builder <span class="comment">//{ArrayBuilder, Builder}</span></span>
<a href="l5"></a><span id="l5"><span class="keyword">import</span> collection.generic.<span class="delimiter">{</span>CanBuildFrom, GenericTraversableTemplate, SeqFactory, GenericCompanion<span class="delimiter">}</span></span>
<a href="l6"></a><span id="l6"></span>
<a href="l7"></a><span id="l7"><span class="comment">//import scales.collection.immutable.Vector</span></span>
<a href="l8"></a><span id="l8"></span>
<a href="l9"></a><span id="l9"><span class="comment">/**</span>
<a href="l10"></a><span id="l10"> * Behaves like an ArrayList/ArrayBuffer, growing an internal array as necessary</span>
<a href="l11"></a><span id="l11"> */</span></span>
<a href="l12"></a><span id="l12">case <span class="keyword">class</span> <a title="class ImmutableArrayBuilder[A] extends java.lang.Object with scala.collection.mutable.Builder[A,scales.utils.ImmutableArray[A]] with ScalaObject with Product with Serializable" id="57982">ImmutableArrayBuilder</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="44087">A</a> <span class="delimiter">]</span><a href="#57982" title="ScalaObject" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArray[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">{</span></span>
<a href="l13"></a><span id="l13"></span>
<a href="l14"></a><span id="l14">  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Double(0.1)" id="41720">gf</a> = <span title="Double(0.1)" class="double">0.10</span></span>
<a href="l15"></a><span id="l15">  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Double(0.95)" id="41722">gp</a> = <span title="Double(0.95)" class="double">0.95</span></span>
<a href="l16"></a><span id="l16"></span>
<a href="l17"></a><span id="l17">  <span class="keyword">def</span> <a title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]" id="41724">resize</a><span class="delimiter">(</span> <a title="Array[AnyRef]" id="43422">orig</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <a title="Int" id="43423">newCapacity</a> : <span title="Int">Int</span>, <a title="Int" id="43424">len</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <span class="delimiter">{</span> </span>
<a href="l18"></a><span id="l18">    <span class="keyword">val</span> <a title="Array[AnyRef]" id="43427">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#43423" title="Int">newCapacity</a><span class="delimiter">)</span></span>
<a href="l19"></a><span id="l19">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#43424" title="Int">len</a> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span></span>
<a href="l20"></a><span id="l20">      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#43422" title="Array[AnyRef]">orig</a>, <span title="Int(0)" class="int">0</span>, <a href="#43427" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#43424" title="Int">len</a><span class="delimiter">)</span></span>
<a href="l21"></a><span id="l21"></span>
<a href="l22"></a><span id="l22">    <a href="#43427" title="Array[AnyRef]">ar</a></span>
<a href="l23"></a><span id="l23">  <span class="delimiter">}</span></span>
<a href="l24"></a><span id="l24"></span>
<a href="l25"></a><span id="l25">  <span class="keyword">var</span> <a title="Array[AnyRef]" id="41726">buf</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span> = _</span>
<a href="l26"></a><span id="l26">  </span>
<a href="l27"></a><span id="l27">  <span class="keyword">var</span> <a title="Int" id="41729">len</a> = <span title="Int(0)" class="int">0</span></span>
<a href="l28"></a><span id="l28"></span>
<a href="l29"></a><span id="l29">  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="41731">ensureSize</a><span class="delimiter">(</span> <a title="Int" id="43693">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l30"></a><span id="l30">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#43693" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l31"></a><span id="l31">      <a href="#41726" title="(x$1: Array[AnyRef])Unit">buf</a> = <a href="#41724" title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]">resize</a><span class="delimiter">(</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>, <a href="#43693" title="Int">size</a>, <a href="#41729" title="=&gt; Int">len</a> <span class="delimiter">)</span></span>
<a href="l32"></a><span id="l32">    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#43693" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span> <span title="(x: Double)Double">*</span> <span title="Double(0.95)">gp</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l33"></a><span id="l33">      <a href="#41726" title="(x$1: Array[AnyRef])Unit">buf</a> = <a href="#41724" title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]">resize</a><span class="delimiter">(</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>, <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span>.<span title="=&gt; Double">toDouble</span> <span title="(x: Double)Double">*</span> <span title="Double(0.1)">gf</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>, <a href="#41729" title="=&gt; Int">len</a> <span class="delimiter">)</span></span>
<a href="l34"></a><span id="l34">    <span class="delimiter">}</span></span>
<a href="l35"></a><span id="l35">  <span class="delimiter">}</span></span>
<a href="l36"></a><span id="l36"></span>
<a href="l37"></a><span id="l37">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="41732">sizeHint</a><span class="delimiter">(</span> <a title="Int" id="43727">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l38"></a><span id="l38">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#43727" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span> <span class="comment">// don't grow unless necessary</span></span>
<a href="l39"></a><span id="l39">      <a href="#41726" title="(x$1: Array[AnyRef])Unit">buf</a> = <a href="#41724" title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]">resize</a><span class="delimiter">(</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>, <a href="#43727" title="Int">size</a>, <a href="#41729" title="=&gt; Int">len</a> <span class="delimiter">)</span></span>
<a href="l40"></a><span id="l40">  <span class="delimiter">}</span></span>
<a href="l41"></a><span id="l41"></span>
<a href="l42"></a><span id="l42">  <span class="keyword">def</span> <a title="()scales.utils.ImmutableArray[A]" id="41733">result</a> : <a href="#57820" title="scales.utils.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = </span>
<a href="l43"></a><span id="l43">    <span title="scales.utils.ImmutableArray[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span></span>
<a href="l44"></a><span id="l44">      <a href="#8926" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a>.<a href="#43749" title="=&gt; scales.utils.ImmutableArray[Nothing]">emptyImmutableArray</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scales.utils.ImmutableArray[A]" class="delimiter">[</span><a href="#57820" title="scales.utils.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l45"></a><span id="l45">    <span class="keyword">else</span></span>
<a href="l46"></a><span id="l46">      <a href="#57820" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a>, <span title="Int(0)" class="int">0</span>, <a href="#41729" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l47"></a><span id="l47"></span>
<a href="l48"></a><span id="l48">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(xs: TraversableOnce[A])ImmutableArrayBuilder.this.type" id="41734">++=</a><span class="delimiter">(</span><a title="TraversableOnce[A]" id="43839">xs</a>: <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <a href="#43839" title="TraversableOnce[A]">xs</a> <span title="ImmutableArrayBuilder.this.type" class="keyword">match</span> <span class="delimiter">{</span></span>
<a href="l49"></a><span id="l49">    <span class="keyword">case</span> <span title="ImmutableArrayBuilder.this.type">ImmutableArray</span><span class="delimiter">(</span> <a title="Array[AnyRef]" id="43888">base</a>, <a title="Int" id="43889">offset</a>, <a title="Int" id="43890">slen</a><span class="delimiter">)</span> =&gt;</span>
<a href="l50"></a><span id="l50">      <a href="#41731" title="(size: Int)Unit">ensureSize</a><span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Int">+</span> <a href="#43890" title="Int">slen</a><span class="delimiter">)</span></span>
<a href="l51"></a><span id="l51">      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#43888" title="Array[AnyRef]">base</a>, <a href="#43889" title="Int">offset</a>, <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>, <a href="#41729" title="=&gt; Int">len</a>, <a href="#43890" title="Int">slen</a><span class="delimiter">)</span></span>
<a href="l52"></a><span id="l52">      <a href="#41729" title="(x$1: Int)Unit">len</a> <span title="(x: Int)Int">+=</span> <a href="#43890" title="Int">slen</a></span>
<a href="l53"></a><span id="l53">      <a href="#57982" title="ImmutableArrayBuilder.this.type" class="keyword">this</a></span>
<a href="l54"></a><span id="l54">    <span class="keyword">case</span> <span title="ImmutableArrayBuilder.this.type">_</span> =&gt;</span>
<a href="l55"></a><span id="l55">      <a href="#57982" title="scales.utils.ImmutableArrayBuilder[A]" class="keyword">super</a>.<span title="(xs: scala.collection.TraversableOnce[A])ImmutableArrayBuilder.this.type">++=</span><span class="delimiter">(</span><a href="#43839" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span></span>
<a href="l56"></a><span id="l56">  <span class="delimiter">}</span></span>
<a href="l57"></a><span id="l57"></span>
<a href="l58"></a><span id="l58">  <span class="keyword">def</span> <a title="(elem: A)ImmutableArrayBuilder.this.type" id="41735">+=</a><span class="delimiter">(</span> <a title="A" id="43978">elem</a> : <a href="#44087" title="A">A</a><span class="delimiter">)</span> : <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span></span>
<a href="l59"></a><span id="l59">    <a href="#41731" title="(size: Int)Unit">ensureSize</a><span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span></span>
<a href="l60"></a><span id="l60">    <span class="comment">// we know its big enough</span></span>
<a href="l61"></a><span id="l61">    <a href="#41726" title="(i: Int, x: AnyRef)Unit">buf</a><span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a><span class="delimiter">)</span> = <a href="#43978" title="A">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span></span>
<a href="l62"></a><span id="l62">    <a href="#41729" title="(x$1: Int)Unit">len</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span></span>
<a href="l63"></a><span id="l63">    <a href="#57982" title="ImmutableArrayBuilder.this.type" class="keyword">this</a></span>
<a href="l64"></a><span id="l64">  <span class="delimiter">}</span></span>
<a href="l65"></a><span id="l65"></span>
<a href="l66"></a><span id="l66">  <span class="keyword">def</span> <a title="()Unit" id="41736">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l67"></a><span id="l67">    <a href="#41729" title="(x$1: Int)Unit">len</a> = <span title="Int(0)" class="int">0</span></span>
<a href="l68"></a><span id="l68">  <span class="delimiter">}</span></span>
<a href="l69"></a><span id="l69"><span class="delimiter">}</span></span>
<a href="l70"></a><span id="l70"></span>
<a href="l71"></a><span id="l71">case <span class="keyword">class</span> <a title="class IAOne[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="57975">IAOne</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="46961">A</a> <span class="delimiter">]</span><a href="#57975" title="ScalaObject" class="delimiter">(</a> <a title="A" id="46965">one</a> : <a href="#46961" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l72"></a><span id="l72"></span>
<a href="l73"></a><span id="l73">  <span class="keyword">def</span> <a title="(idx: Int)A" id="44113">apply</a><span class="delimiter">(</span><a title="Int" id="44145">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#46965" title="=&gt; A">one</a></span>
<a href="l74"></a><span id="l74"></span>
<a href="l75"></a><span id="l75">  <span class="keyword">def</span> <a title="=&gt; Int" id="44114">length</a> = <span title="Int(1)" class="int">1</span></span>
<a href="l76"></a><span id="l76"></span>
<a href="l77"></a><span id="l77">  <span class="keyword">def</span> <a title="=&gt; scales.utils.IAOne[A]" id="44115">ar</a> = <a href="#57975" title="scales.utils.IAOne[A]" class="keyword">this</a></span>
<a href="l78"></a><span id="l78"></span>
<a href="l79"></a><span id="l79"><span class="delimiter">}</span></span>
<a href="l80"></a><span id="l80"></span>
<a href="l81"></a><span id="l81"><span class="keyword">import</span> scala.annotation.switch</span>
<a href="l82"></a><span id="l82"></span>
<a href="l83"></a><span id="l83">case <span class="keyword">class</span> <a title="class IATwo[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="57948">IATwo</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="57905">A</a> <span class="delimiter">]</span><a href="#57948" title="ScalaObject" class="delimiter">(</a> <a title="A" id="57940">one</a> : <a href="#57905" title="A">A</a>, <a title="A" id="57941">two</a> : <a href="#57905" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l84"></a><span id="l84"></span>
<a href="l85"></a><span id="l85">  <span class="keyword">def</span> <a title="(idx: Int)A" id="44191">apply</a><span class="delimiter">(</span><a title="Int" id="44225">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#44225" title="Int">idx</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="A" class="keyword">match</span> <span class="delimiter">{</span></span>
<a href="l86"></a><span id="l86">    <span class="keyword">case</span> <span title="IATwo.this.one.type" class="int">0</span> =&gt; <a href="#57940" title="=&gt; A">one</a></span>
<a href="l87"></a><span id="l87">    <span class="keyword">case</span> <span title="IATwo.this.two.type" class="int">1</span> =&gt; <a href="#57941" title="=&gt; A">two</a></span>
<a href="l88"></a><span id="l88">  <span class="delimiter">}</span></span>
<a href="l89"></a><span id="l89"></span>
<a href="l90"></a><span id="l90">  <span class="keyword">def</span> <a title="=&gt; Int" id="44192">length</a> = <span title="Int(2)" class="int">2</span></span>
<a href="l91"></a><span id="l91"></span>
<a href="l92"></a><span id="l92">  <span class="keyword">def</span> <a title="=&gt; scales.utils.IATwo[A]" id="44193">ar</a> = <a href="#57948" title="scales.utils.IATwo[A]" class="keyword">this</a></span>
<a href="l93"></a><span id="l93"></span>
<a href="l94"></a><span id="l94"><span class="delimiter">}</span></span>
<a href="l95"></a><span id="l95"></span>
<a href="l96"></a><span id="l96">case <span class="keyword">class</span> <a title="class IAThree[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="57900">IAThree</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="57851">A</a> <span class="delimiter">]</span><a href="#57900" title="ScalaObject" class="delimiter">(</a> <a title="A" id="57889">one</a> : <a href="#57851" title="A">A</a>, <a title="A" id="57890">two</a> : <a href="#57851" title="A">A</a>, <a title="A" id="57891">three</a> : <a href="#57851" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l97"></a><span id="l97"></span>
<a href="l98"></a><span id="l98">  <span class="keyword">def</span> <a title="(idx: Int)A" id="44283">apply</a><span class="delimiter">(</span><a title="Int" id="44319">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#44319" title="Int">idx</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="A" class="keyword">match</span> <span class="delimiter">{</span></span>
<a href="l99"></a><span id="l99">    <span class="keyword">case</span> <span title="IAThree.this.one.type" class="int">0</span> =&gt; <a href="#57889" title="=&gt; A">one</a></span>
<a href="l100"></a><span id="l100">    <span class="keyword">case</span> <span title="IAThree.this.two.type" class="int">1</span> =&gt; <a href="#57890" title="=&gt; A">two</a></span>
<a href="l101"></a><span id="l101">    <span class="keyword">case</span> <span title="IAThree.this.three.type" class="int">2</span> =&gt; <a href="#57891" title="=&gt; A">three</a></span>
<a href="l102"></a><span id="l102">  <span class="delimiter">}</span></span>
<a href="l103"></a><span id="l103"></span>
<a href="l104"></a><span id="l104">  <span class="keyword">def</span> <a title="=&gt; Int" id="44284">length</a> = <span title="Int(3)" class="int">3</span></span>
<a href="l105"></a><span id="l105"></span>
<a href="l106"></a><span id="l106">  <span class="keyword">def</span> <a title="=&gt; scales.utils.IAThree[A]" id="44285">ar</a> = <a href="#57900" title="scales.utils.IAThree[A]" class="keyword">this</a></span>
<a href="l107"></a><span id="l107"></span>
<a href="l108"></a><span id="l108"><span class="delimiter">}</span></span>
<a href="l109"></a><span id="l109"></span>
<a href="l110"></a><span id="l110"></span>
<a href="l111"></a><span id="l111"><span class="comment">/**</span>
<a href="l112"></a><span id="l112"> * Object arrays are just faster, System.arraycopy doesn't trust you and will type check everything, we can let nsc do that job for us.</span>
<a href="l113"></a><span id="l113"> *</span>
<a href="l114"></a><span id="l114"> * Same as ImmutableArray but for when the base is the entire collection, no offset or len are then needed</span>
<a href="l115"></a><span id="l115"> */</span> </span>
<a href="l116"></a><span id="l116"><span class="keyword">trait</span> <a title="trait ImmutableArrayT[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject" id="8916">ImmutableArrayT</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="8917">A</a> <span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l117"></a><span id="l117">  <span class="keyword">val</span> <a title="=&gt; Array[AnyRef]" id="41742">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span></span>
<a href="l118"></a><span id="l118">  <span class="keyword">def</span> <a title="=&gt; Int" id="41743">offset</a> : <span title="Int">Int</span></span>
<a href="l119"></a><span id="l119">  <span class="keyword">def</span> <a title="=&gt; Int" id="41744">len</a> : <span title="Int">Int</span></span>
<a href="l120"></a><span id="l120"></span>
<a href="l121"></a><span id="l121">  <span class="keyword">import</span> <a href="#46530" title="object scales.utils.ImmutableArrayProxyBuilder">ImmutableArrayProxyBuilder</a>._</span>
<a href="l122"></a><span id="l122"></span>
<a href="l123"></a><span id="l123">  <span class="keyword">def</span> <a title="(idx: Int)A" id="41746">apply</a><span class="delimiter">(</span><a title="Int" id="44410">idx</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#41742" title="(i: Int)AnyRef">base</a><span class="delimiter">(</span><a href="#44410" title="Int">idx</a> <span title="(x: Int)Int">+</span> <a href="#41743" title="=&gt; Int">offset</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#8917" title="A">A</a><span class="delimiter">]</span></span>
<a href="l124"></a><span id="l124"> </span>
<a href="l125"></a><span id="l125">  <span class="keyword">def</span> <a title="=&gt; Int" id="41747">length</a> = <a href="#41744" title="=&gt; Int">len</a></span>
<a href="l126"></a><span id="l126">  </span>
<a href="l127"></a><span id="l127">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="41748">+:</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="41751">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="41752">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="44431">elem</a>: <a href="#41751" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="44432">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#41752" title="That">That</a> =</span>
<a href="l128"></a><span id="l128">    <span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <span title="Int(31)">vectorAfter</span><span class="delimiter">)</span> <a href="#8916" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That">+:</span><a href="#44432" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" class="delimiter">(</a><a href="#44431" title="B">elem</a><span class="delimiter">)</span></span>
<a href="l129"></a><span id="l129">    <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l130"></a><span id="l130">      <span class="keyword">val</span> <a title="Array[AnyRef]" id="44490">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span></span>
<a href="l131"></a><span id="l131">      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <a href="#44490" title="Array[AnyRef]">ar</a>, <span title="Int(1)" class="int">1</span>, <a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l132"></a><span id="l132">      <a href="#44490" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <a href="#44431" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span></span>
<a href="l133"></a><span id="l133">      <a href="#57846" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#41751" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#44490" title="Array[AnyRef]">ar</a><span class="delimiter">)</span></span>
<a href="l134"></a><span id="l134">    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#41752" title="That">That</a><span class="delimiter">]</span></span>
<a href="l135"></a><span id="l135">  </span>
<a href="l136"></a><span id="l136">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="41753">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="41756">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="41757">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="44594">elem</a>: <a href="#41756" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="44595">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#41757" title="That">That</a> =</span>
<a href="l137"></a><span id="l137">    <span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <span title="Int(31)">vectorAfter</span><span class="delimiter">)</span> <a href="#8916" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That">:+</span><a href="#44595" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" class="delimiter">(</a><a href="#44594" title="B">elem</a><span class="delimiter">)</span></span>
<a href="l138"></a><span id="l138">    <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l139"></a><span id="l139">      <span class="keyword">val</span> <a title="Array[AnyRef]" id="44653">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span></span>
<a href="l140"></a><span id="l140">      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <a href="#44653" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l141"></a><span id="l141">      <a href="#44653" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span> = <a href="#44594" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span></span>
<a href="l142"></a><span id="l142">      <a href="#57846" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#41756" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#44653" title="Array[AnyRef]">ar</a><span class="delimiter">)</span></span>
<a href="l143"></a><span id="l143">    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#41757" title="That">That</a><span class="delimiter">]</span></span>
<a href="l144"></a><span id="l144"></span>
<a href="l145"></a><span id="l145">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.ImmutableArray[Nothing]" id="41758">take</a><span class="delimiter">(</span> <a title="Int" id="44719">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = </span>
<a href="l146"></a><span id="l146">    <a href="#57820" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#44719" title="Int">n</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#41744" title="=&gt; Int">len</a> <span class="keyword">else</span> <a href="#44719" title="Int">n</a><span class="delimiter">)</span></span>
<a href="l147"></a><span id="l147"></span>
<a href="l148"></a><span id="l148">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.ImmutableArray[Nothing]" id="41759">drop</a><span class="delimiter">(</span> <a title="Int" id="44735">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = </span>
<a href="l149"></a><span id="l149">    <a href="#57820" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a> <span title="(x: Int)Int">+</span> <a href="#44735" title="Int">n</a>, <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#44735" title="Int">n</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#44735" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l150"></a><span id="l150"></span>
<a href="l151"></a><span id="l151">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scales.utils.ImmutableArray[Nothing]" id="41760">tail</a> = <a href="#41759" title="(n: Int)scales.utils.ImmutableArray[Nothing]">drop</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span></span>
<a href="l152"></a><span id="l152"></span>
<a href="l153"></a><span id="l153">  <span class="comment">/**</span>
<a href="l154"></a><span id="l154">   * we can do better - slice used by many functions in Optimized</span>
<a href="l155"></a><span id="l155">   */</span> </span>
<a href="l156"></a><span id="l156">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(from: Int, until: Int)scales.utils.ImmutableArray[Nothing]" id="41761">slice</a><span class="delimiter">(</span><a title="Int" id="44766">from</a>: <span title="Int">Int</span>, <a title="Int" id="44767">until</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span></span>
<a href="l157"></a><span id="l157">    <span class="keyword">val</span> <a title="Int" id="44770">lo</a>    = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#44766" title="Int">from</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span></span>
<a href="l158"></a><span id="l158">    <span class="keyword">val</span> <a title="Int" id="44771">hi</a>    = math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#44767" title="Int">until</a>, <a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l159"></a><span id="l159">    <span class="keyword">val</span> <a title="Int" id="44772">elems</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#44771" title="Int">hi</a> <span title="(x: Int)Int">-</span> <a href="#44770" title="Int">lo</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span></span>
<a href="l160"></a><span id="l160">    <a href="#57820" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <a href="#44772" title="Int">elems</a><span class="delimiter">)</span></span>
<a href="l161"></a><span id="l161">  <span class="delimiter">}</span></span>
<a href="l162"></a><span id="l162"></span>
<a href="l163"></a><span id="l163">  <span class="comment">/**</span>
<a href="l164"></a><span id="l164">   * Basically optimised version for back, hint used directly, one new array creation</span>
<a href="l165"></a><span id="l165">   */</span> </span>
<a href="l166"></a><span id="l166">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="41762">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="41765">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="41766">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="44808">index</a>: <span title="Int">Int</span>, <a title="B" id="44809">elem</a>: <a href="#41765" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="44810">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#41766" title="That">That</a> =</span>
<a href="l167"></a><span id="l167">    <span title="That" class="keyword">if</span> <span class="delimiter">(</span><a href="#44810" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">bf</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span>ImmutableArrayProxy.<a href="#43760" title="scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[_]">ImmutableArrayProxyCBF</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l168"></a><span id="l168">      <span class="comment">// we know its objects underneath, we know the relationship is sound</span></span>
<a href="l169"></a><span id="l169">      <span class="keyword">val</span> <a title="Array[AnyRef]" id="44852">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l170"></a><span id="l170">      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <a href="#44852" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l171"></a><span id="l171">      <a href="#44852" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><a href="#44808" title="Int">index</a><span class="delimiter">)</span> = <a href="#44809" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span></span>
<a href="l172"></a><span id="l172">      <a href="#57846" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#41765" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#44852" title="Array[AnyRef]">ar</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#41766" title="That">That</a><span class="delimiter">]</span></span>
<a href="l173"></a><span id="l173">    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l174"></a><span id="l174">      <span class="keyword">val</span> <a title="scala.collection.mutable.Builder[B,That]" id="44870">b</a> = <a href="#44810" title="(from: scales.utils.ImmutableArrayProxy[A])scala.collection.mutable.Builder[B,That]">bf</a><span class="delimiter">(</span><a href="#8916" title="=&gt; scales.utils.ImmutableArrayProxy[A]">repr</a><span class="delimiter">)</span></span>
<a href="l175"></a><span id="l175">      <span class="keyword">val</span> <a href="#44872" title="(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A])" class="delimiter">(</a><a href="#44871" title="scales.utils.ImmutableArrayProxy[A]" id="44872">prefix</a>, <a href="#44871" title="scales.utils.ImmutableArrayProxy[A]" id="44873">rest</a><span class="delimiter">)</span> = <a href="#8916" title="ImmutableArrayT.this.type" class="keyword">this</a>.<span title="(n: Int)(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A])">splitAt</span><span title="(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A]) @unchecked" class="delimiter">(</span><a href="#44808" title="Int">index</a><span class="delimiter">)</span></span>
<a href="l176"></a><span id="l176">      <a href="#44870" title="scala.collection.mutable.Builder[B,That]">b</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l177"></a><span id="l177">      <a href="#44870" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(xs: scala.collection.TraversableOnce[B])b.type">++=</span> <a href="#8916" title="(repr: scales.utils.ImmutableArrayProxy[A])IndexedSeq[A]">toCollection</a><span class="delimiter">(</span><a href="#44872" title="scales.utils.ImmutableArrayProxy[A]">prefix</a><span class="delimiter">)</span></span>
<a href="l178"></a><span id="l178">      <a href="#44870" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(elem: B)b.type">+=</span> <a href="#44809" title="B">elem</a></span>
<a href="l179"></a><span id="l179">      <a href="#44870" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(xs: scala.collection.TraversableOnce[B])b.type">++=</span> <a href="#8916" title="(repr: scales.utils.ImmutableArrayProxy[A])IndexedSeq[A]">toCollection</a><span class="delimiter">(</span><a href="#44873" title="scales.utils.ImmutableArrayProxy[A]">rest</a>.<span title="=&gt; scales.utils.ImmutableArrayProxy[A]">tail</span><span class="delimiter">)</span></span>
<a href="l180"></a><span id="l180">      <a href="#44870" title="scala.collection.mutable.Builder[B,That]">b</a>.<span title="()That">result</span><span class="delimiter">(</span><span class="delimiter">)</span></span>
<a href="l181"></a><span id="l181">    <span class="delimiter">}</span></span>
<a href="l182"></a><span id="l182"></span>
<a href="l183"></a><span id="l183">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[U &gt;: A](implicit evidence$1: ClassManifest[U])Array[U]" id="44944">toArray</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="41769">U</a> &gt;: A : ClassManifest<span class="delimiter">]</span>: <span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span> =</span>
<a href="l184"></a><span id="l184">    <span title="Array[U]" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit e: T)T">implicitly</span><a href="#44944" title="(implicit e: ClassManifest[U])ClassManifest[U]" class="delimiter">[</a><span title="ClassManifest[U]">ClassManifest</span><span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="=&gt; java.lang.Class[_]">erasure</span> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#41742" title="=&gt; Array[AnyRef]">base</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.Class[_]">getComponentType</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l185"></a><span id="l185">      <span title="Array[U]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#41743" title="=&gt; Int">offset</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#41744" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#41742" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l186"></a><span id="l186">	<a href="#41742" title="=&gt; Array[AnyRef]">base</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Array[U]" class="delimiter">[</span><span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l187"></a><span id="l187">      <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l188"></a><span id="l188">	<span class="keyword">val</span> <a title="Array[U]" id="46383">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[U])Array[U]" class="delimiter">[</span><a href="#41769" title="U">U</a><span class="delimiter">]</span><a href="#44944" title="ClassManifest[U]" class="delimiter">(</a><a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l189"></a><span id="l189">	<span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#41742" title="=&gt; Array[AnyRef]">base</a>, <a href="#41743" title="=&gt; Int">offset</a>, <a href="#46383" title="Array[U]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#41744" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l190"></a><span id="l190">	<a href="#46383" title="Array[U]">ar</a>	</span>
<a href="l191"></a><span id="l191">      <span class="delimiter">}</span></span>
<a href="l192"></a><span id="l192">    <span class="delimiter">}</span> <span class="keyword">else</span> </span>
<a href="l193"></a><span id="l193">      <a href="#8916" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="[B &gt;: A](implicit evidence$1: ClassManifest[B])Array[B]">toArray</span><a href="#44944" title="(implicit evidence$1: ClassManifest[U])Array[U]" class="delimiter">[</a><a href="#41769" title="U">U</a><span class="delimiter">]</span></span>
<a href="l194"></a><span id="l194"></span>
<a href="l195"></a><span id="l195"></span>
<a href="l196"></a><span id="l196">  <span class="keyword">def</span> <a title="=&gt; scales.utils.ImmutableArrayT[A]" id="41770">ar</a> = <a href="#8916" title="scales.utils.ImmutableArrayT[A]" class="keyword">this</a></span>
<a href="l197"></a><span id="l197"><span class="delimiter">}</span></span>
<a href="l198"></a><span id="l198"></span>
<a href="l199"></a><span id="l199"><span class="comment">/**</span>
<a href="l200"></a><span id="l200"> * Don't add the offset and length, for building a dom this save 8 per elem, only matters for large docs (can save 4mb from 54mb), but can't hurt small ones.</span>
<a href="l201"></a><span id="l201"> */</span> </span>
<a href="l202"></a><span id="l202">case <span class="keyword">class</span> <a title="class ImmutableArrayAll[+A] extends java.lang.Object with scales.utils.ImmutableArrayT[A] with ScalaObject with Product with Serializable" id="57846">ImmutableArrayAll</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="44516">A</a> <span class="delimiter">]</span><a href="#57846" title="ScalaObject" class="delimiter">(</a> <a title="Array[AnyRef]" id="44530">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8916" title="scales.utils.ImmutableArrayT[A]">ImmutableArrayT</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l203"></a><span id="l203">  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="44521">offset</a> = <span title="Int(0)" class="int">0</span></span>
<a href="l204"></a><span id="l204">  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="44522">len</a> = <a href="#44530" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span></span>
<a href="l205"></a><span id="l205">  @inline <span class="keyword">final</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="44523">length</a> = <a href="#44530" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span></span>
<a href="l206"></a><span id="l206"><span class="delimiter">}</span></span>
<a href="l207"></a><span id="l207"></span>
<a href="l208"></a><span id="l208"><span class="comment">/**</span>
<a href="l209"></a><span id="l209"> * Object arrays are just faster, System.arraycopy doesn't trust you and will type check everything, we can let nsc do that job for us.</span>
<a href="l210"></a><span id="l210"> */</span> </span>
<a href="l211"></a><span id="l211">case <span class="keyword">class</span> <a title="class ImmutableArray[+A] extends java.lang.Object with scales.utils.ImmutableArrayT[A] with ScalaObject with Product with Serializable" id="57820">ImmutableArray</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="43829">A</a> <span class="delimiter">]</span><a href="#57820" title="ScalaObject" class="delimiter">(</a> <a title="Array[AnyRef]" id="43833">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <a title="Int" id="43834">offset</a> : <span title="Int">Int</span>, <a title="Int" id="43835">len</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8916" title="scales.utils.ImmutableArrayT[A]">ImmutableArrayT</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l212"></a><span id="l212"></span>
<a href="l213"></a><span id="l213"><span class="comment">/*  import ImmutableArrayProxyBuilder._</span>
<a href="l214"></a><span id="l214"></span>
<a href="l215"></a><span id="l215">  def apply(idx : Int ) = base(idx + offset).asInstanceOf[A]</span>
<a href="l216"></a><span id="l216"> </span>
<a href="l217"></a><span id="l217">  def length = len</span>
<a href="l218"></a><span id="l218">  </span>
<a href="l219"></a><span id="l219">  @inline override def +:[B &gt;: A, That](elem: B)(implicit bf: CanBuildFrom[ImmutableArrayProxy[A], B, That]): That =</span>
<a href="l220"></a><span id="l220">    (if (len == vectorAfter) super.+:(elem)</span>
<a href="l221"></a><span id="l221">    else {</span>
<a href="l222"></a><span id="l222">      val ar = Array.ofDim[AnyRef](len+1)</span>
<a href="l223"></a><span id="l223">      Array.copy(base, offset, ar, 1, len)</span>
<a href="l224"></a><span id="l224">      ar(0) = elem.asInstanceOf[AnyRef]</span>
<a href="l225"></a><span id="l225">      ImmutableArray[B](ar, 0, len+1)</span>
<a href="l226"></a><span id="l226">    }).asInstanceOf[That]</span>
<a href="l227"></a><span id="l227">  </span>
<a href="l228"></a><span id="l228">  @inline override def :+[B &gt;: A, That](elem: B)(implicit bf: CanBuildFrom[ImmutableArrayProxy[A], B, That]): That =</span>
<a href="l229"></a><span id="l229">    (if (len == vectorAfter) super.:+(elem)</span>
<a href="l230"></a><span id="l230">    else {</span>
<a href="l231"></a><span id="l231">      val ar = Array.ofDim[AnyRef](len+1)</span>
<a href="l232"></a><span id="l232">      Array.copy(base, offset, ar, 0, len)</span>
<a href="l233"></a><span id="l233">      ar(len) = elem.asInstanceOf[AnyRef]</span>
<a href="l234"></a><span id="l234">      ImmutableArray[B](ar, 0, len+1).asInstanceOf[That]</span>
<a href="l235"></a><span id="l235">    }).asInstanceOf[That]</span>
<a href="l236"></a><span id="l236"></span>
<a href="l237"></a><span id="l237">  @inline override def take( n : Int ) = </span>
<a href="l238"></a><span id="l238">    ImmutableArray(base, offset, if (len - n &lt; 0) len else n)</span>
<a href="l239"></a><span id="l239"></span>
<a href="l240"></a><span id="l240">  @inline override def drop( n : Int ) = </span>
<a href="l241"></a><span id="l241">    ImmutableArray(base, offset + n, if (len - n &lt; 0) 0 else (len - n))</span>
<a href="l242"></a><span id="l242"></span>
<a href="l243"></a><span id="l243">  @inline override def tail = drop(1)</span>
<a href="l244"></a><span id="l244"></span>
<a href="l245"></a><span id="l245">  /**</span>
<a href="l246"></a><span id="l246">   * we can do better - slice used by many functions in Optimized</span>
<a href="l247"></a><span id="l247">   */ </span>
<a href="l248"></a><span id="l248">  @inline override def slice(from: Int, until: Int) = {</span>
<a href="l249"></a><span id="l249">    val lo    = math.max(from, 0)</span>
<a href="l250"></a><span id="l250">    val hi    = math.min(until, len)</span>
<a href="l251"></a><span id="l251">    val elems = math.max(hi - lo, 0)</span>
<a href="l252"></a><span id="l252">    ImmutableArray(base, offset, elems)</span>
<a href="l253"></a><span id="l253">  }</span>
<a href="l254"></a><span id="l254"></span>
<a href="l255"></a><span id="l255">  /**</span>
<a href="l256"></a><span id="l256">   * Basically optimised version for back, hint used directly, one new array creation</span>
<a href="l257"></a><span id="l257">   */ </span>
<a href="l258"></a><span id="l258">  override def updated[B &gt;: A, That](index: Int, elem: B)(implicit bf: CanBuildFrom[ImmutableArrayProxy[A], B, That]): That =</span>
<a href="l259"></a><span id="l259">    if (bf.isInstanceOf[ImmutableArrayProxy.ImmutableArrayProxyCBF[_]]) {</span>
<a href="l260"></a><span id="l260">      // we know its objects underneath, we know the relationship is sound</span>
<a href="l261"></a><span id="l261">      val ar = Array.ofDim[AnyRef](len)</span>
<a href="l262"></a><span id="l262">      Array.copy(base, offset, ar, 0, len)</span>
<a href="l263"></a><span id="l263">      ar(index) = elem.asInstanceOf[AnyRef]</span>
<a href="l264"></a><span id="l264">      ImmutableArray[B](ar, 0, len).asInstanceOf[That]</span>
<a href="l265"></a><span id="l265">    } else {</span>
<a href="l266"></a><span id="l266">      val b = bf(repr)</span>
<a href="l267"></a><span id="l267">      val (prefix, rest) = this.splitAt(index)</span>
<a href="l268"></a><span id="l268">      b.sizeHint(len)</span>
<a href="l269"></a><span id="l269">      b ++= toCollection(prefix)</span>
<a href="l270"></a><span id="l270">      b += elem</span>
<a href="l271"></a><span id="l271">      b ++= toCollection(rest.tail)</span>
<a href="l272"></a><span id="l272">      b.result</span>
<a href="l273"></a><span id="l273">    }</span>
<a href="l274"></a><span id="l274"></span>
<a href="l275"></a><span id="l275">  override def toArray[U &gt;: A : ClassManifest]: Array[U] =</span>
<a href="l276"></a><span id="l276">    if (implicitly[ClassManifest[U]].erasure eq base.getClass.getComponentType) {</span>
<a href="l277"></a><span id="l277">      if ((offset == 0) &amp;&amp; (len == base.length))</span>
<a href="l278"></a><span id="l278">	base.asInstanceOf[Array[U]]</span>
<a href="l279"></a><span id="l279">      else {</span>
<a href="l280"></a><span id="l280">	val ar = Array.ofDim[U](len)</span>
<a href="l281"></a><span id="l281">	Array.copy(base, offset, ar, 0, len)</span>
<a href="l282"></a><span id="l282">	ar	</span>
<a href="l283"></a><span id="l283">      }</span>
<a href="l284"></a><span id="l284">    } else </span>
<a href="l285"></a><span id="l285">      super.toArray[U]</span>
<a href="l286"></a><span id="l286"></span>
<a href="l287"></a><span id="l287"></span>
<a href="l288"></a><span id="l288">  def ar = this */</span></span>
<a href="l289"></a><span id="l289"><span class="delimiter">}</span></span>
<a href="l290"></a><span id="l290"></span>
<a href="l291"></a><span id="l291"><span class="comment">/**</span>
<a href="l292"></a><span id="l292"> * Starts an ImmutableArrayProxy and provides the CanBuildFrom</span>
<a href="l293"></a><span id="l293"> */</span> </span>
<a href="l294"></a><span id="l294"><span class="keyword">object</span> <a title="object scales.utils.ImmutableArrayProxy" id="8926">ImmutableArrayProxy</a> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.collection.generic.SeqFactory[scales.utils.ImmutableArrayProxy]">SeqFactory</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l295"></a><span id="l295">  <span class="keyword">val</span> <a title="scales.utils.ImmutableArray[Nothing]" id="43749">emptyImmutableArray</a> = <span title="scales.utils.ImmutableArray[Nothing]" class="keyword">new</span> <a href="#57820" title="scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span><span class="delimiter">(</span><span title="[T](xs: T*)(implicit evidence$2: scala.reflect.ClassManifest[T])Array[T]">Array</span><span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><span class="delimiter">)</span>,<span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span></span>
<a href="l296"></a><span id="l296"></span>
<a href="l297"></a><span id="l297">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A]=&gt; scales.utils.ImmutableArrayProxy[A]" id="43751">empty</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="43753">A</a> <span class="delimiter">]</span> : <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span>  = <a href="#43749" title="=&gt; scales.utils.ImmutableArray[Nothing]">emptyImmutableArray</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scales.utils.ImmutableArrayProxy[A]" class="delimiter">[</span><a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l298"></a><span id="l298"></span>
<a href="l299"></a><span id="l299">  @inline <span class="keyword">def</span> <a title="[A]=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" id="43754">newBuilder</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="43756">A</a><span class="delimiter">]</span></span>
<a href="l300"></a><span id="l300">  : <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =</span>
<a href="l301"></a><span id="l301">    <a href="#56805" title="()scales.utils.ImmutableArrayProxyBuilder[A]">ImmutableArrayProxyBuilder</a><span class="delimiter">(</span><span class="delimiter">)</span></span>
<a href="l302"></a><span id="l302">  </span>
<a href="l303"></a><span id="l303">  @inline <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](implicit ma: ClassManifest[T])scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]" id="43757">canBuildFrom</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="43759">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="ClassManifest[T]" id="43817">ma</a>: <span title="ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#46490" title="java.lang.Object with scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[T]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[T]" id="46490">ImmutableArrayProxyCBF</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">{</span> <span class="keyword">val</span> <a title="ClassManifest[T]" id="46494">m</a> = <a href="#43817" title="ClassManifest[T]">ma</a> <span class="delimiter">}</span></span>
<a href="l304"></a><span id="l304"></span>
<a href="l305"></a><span id="l305">  <span class="keyword">trait</span> <a title="trait ImmutableArrayProxyCBF[T] extends java.lang.Object with scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]] with ScalaObject" id="43760">ImmutableArrayProxyCBF</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="43761">T</a><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l306"></a><span id="l306">    </span>
<a href="l307"></a><span id="l307">    <span class="keyword">val</span> <a title="=&gt; ClassManifest[T]" id="44848">m</a> : <span title="ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span></span>
<a href="l308"></a><span id="l308"></span>
<a href="l309"></a><span id="l309">    <span class="keyword">def</span> <a title="(from: scales.utils.ImmutableArrayProxy[_])scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]" id="44849">apply</a><span class="delimiter">(</span><a title="scales.utils.ImmutableArrayProxy[_]" id="46509">from</a>: <a href="#8932" title="scales.utils.ImmutableArrayProxy[_]">ImmutableArrayProxy</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">Builder</span><span class="delimiter">[</span>T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#43754" title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">newBuilder</a></span>
<a href="l310"></a><span id="l310">    <span class="keyword">def</span> <a title="()scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]" id="44850">apply</a>: <span title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">Builder</span><span class="delimiter">[</span>T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#43754" title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">newBuilder</a></span>
<a href="l311"></a><span id="l311">  <span class="delimiter">}</span></span>
<a href="l312"></a><span id="l312">    </span>
<a href="l313"></a><span id="l313"><span class="delimiter">}</span></span>
<a href="l314"></a><span id="l314"></span>
<a href="l315"></a><span id="l315"><span class="keyword">object</span> <a title="object scales.utils.ImmutableArrayProxyBuilder" id="46530">ImmutableArrayProxyBuilder</a> <span title="ScalaObject" class="delimiter">{</span></span>
<a href="l316"></a><span id="l316">  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(31)" id="44383">vectorAfter</a> = <span title="Int(31)" class="int">31</span></span>
<a href="l317"></a><span id="l317"><span class="delimiter">}</span></span>
<a href="l318"></a><span id="l318"></span>
<a href="l319"></a><span id="l319"><span class="comment">/**</span>
<a href="l320"></a><span id="l320"> * An attempt to be a little more efficient with ImmutableArray, should make up for update not working?</span>
<a href="l321"></a><span id="l321"> */</span></span>
<a href="l322"></a><span id="l322">case <span class="keyword">class</span> <a title="[A](x$0: scales.utils.ImmutableArrayProxyBuilder[A])Boolean" id="56805">ImmutableArrayProxyBuilder</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="8931">A</a> <span class="delimiter">]</span><a href="#56805" title="ScalaObject" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">{</span></span>
<a href="l323"></a><span id="l323">  <span class="keyword">import</span> <a href="#46530" title="object scales.utils.ImmutableArrayProxyBuilder">ImmutableArrayProxyBuilder</a>._</span>
<a href="l324"></a><span id="l324"></span>
<a href="l325"></a><span id="l325">  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scales.utils.ImmutableArrayBuilder[A]" id="44391">arrayBuilder</a> = <span title="scales.utils.ImmutableArrayBuilder[A]" class="keyword">new</span> <a href="#57982" title="scales.utils.ImmutableArrayBuilder[A]">ImmutableArrayBuilder</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span></span>
<a href="l326"></a><span id="l326">  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" id="44393">vectorBuilder</a> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="[A]=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">newBuilder</span><span title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" class="delimiter">[</span><a href="#8931" title="A">A</a><span class="delimiter">]</span></span>
<a href="l327"></a><span id="l327">  </span>
<a href="l328"></a><span id="l328">  <span class="keyword">var</span> <a title="Boolean" id="44395">inVector</a> = <span title="Boolean(false)" class="keyword">false</span></span>
<a href="l329"></a><span id="l329">  <span class="keyword">var</span> <a title="Boolean" id="44398">haveChosen</a> = <span title="Boolean(false)" class="keyword">false</span></span>
<a href="l330"></a><span id="l330"></span>
<a href="l331"></a><span id="l331">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="44400">sizeHint</a><span class="delimiter">(</span> <a title="Int" id="46667">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l332"></a><span id="l332">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#46667" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(31)">vectorAfter</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l333"></a><span id="l333">      <a href="#44395" title="(x$1: Boolean)Unit">inVector</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l334"></a><span id="l334">      <a href="#44398" title="(x$1: Boolean)Unit">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l335"></a><span id="l335">    <span class="delimiter">}</span></span>
<a href="l336"></a><span id="l336"></span>
<a href="l337"></a><span id="l337">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l338"></a><span id="l338">      <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#46667" title="Int">size</a><span class="delimiter">)</span></span>
<a href="l339"></a><span id="l339">    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l340"></a><span id="l340">      <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41732" title="(size: Int)Unit">sizeHint</a><span class="delimiter">(</span><a href="#46667" title="Int">size</a><span class="delimiter">)</span></span>
<a href="l341"></a><span id="l341">    <span class="delimiter">}</span></span>
<a href="l342"></a><span id="l342">  <span class="delimiter">}</span></span>
<a href="l343"></a><span id="l343"></span>
<a href="l344"></a><span id="l344">  <span class="comment">// for the case when we were under 32 but are now over</span></span>
<a href="l345"></a><span id="l345">  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="44401">checkVB</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l346"></a><span id="l346">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l347"></a><span id="l347">      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(31)">vectorAfter</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l348"></a><span id="l348">	<a href="#44402" title="()Unit">moveToVector</a></span>
<a href="l349"></a><span id="l349">      <span class="delimiter">}</span></span>
<a href="l350"></a><span id="l350">    <span class="delimiter">}</span></span>
<a href="l351"></a><span id="l351">  <span class="delimiter">}</span></span>
<a href="l352"></a><span id="l352"></span>
<a href="l353"></a><span id="l353">  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="44402">moveToVector</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l354"></a><span id="l354">    <span class="comment">// copy over</span></span>
<a href="l355"></a><span id="l355">    <span class="keyword">val</span> <a title="scales.utils.ImmutableArray[A]" id="46703">r</a> = <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41733" title="()scales.utils.ImmutableArray[A]">result</a></span>
<a href="l356"></a><span id="l356">    <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#46703" title="scales.utils.ImmutableArray[A]">r</a>.<a href="#43835" title="=&gt; Int">len</a><span class="delimiter">)</span></span>
<a href="l357"></a><span id="l357">    <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])ImmutableArrayProxyBuilder.this.vectorBuilder.type">++=</span><span class="delimiter">(</span><a href="#46703" title="scales.utils.ImmutableArray[A]">r</a><span class="delimiter">)</span></span>
<a href="l358"></a><span id="l358">    <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41736" title="()Unit">clear</a></span>
<a href="l359"></a><span id="l359">    <a href="#44395" title="(x$1: Boolean)Unit">inVector</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l360"></a><span id="l360">    <a href="#44398" title="(x$1: Boolean)Unit">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l361"></a><span id="l361">  <span class="delimiter">}</span></span>
<a href="l362"></a><span id="l362"></span>
<a href="l363"></a><span id="l363">  <span class="keyword">def</span> <a title="()scales.utils.ImmutableArrayProxy[A]" id="44403">result</a> : <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =</span>
<a href="l364"></a><span id="l364">    <span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span> <a href="#57814" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="()scala.collection.immutable.Vector[A]">result</span><span class="delimiter">)</span></span>
<a href="l365"></a><span id="l365">    <span class="keyword">else</span> <span class="delimiter">{</span> <span class="comment">// do it here as this is the correct type</span></span>
<a href="l366"></a><span id="l366">      <span class="keyword">import</span> <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<span class="delimiter">{</span>buf, len<span class="delimiter">}</span></span>
<a href="l367"></a><span id="l367">      <span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span></span>
<a href="l368"></a><span id="l368">	<a href="#57975" title="(one: A)scales.utils.IAOne[A]">IAOne</a><span class="delimiter">(</span><a href="#41726" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#8931" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span></span>
<a href="l369"></a><span id="l369">      <span class="keyword">else</span></span>
<a href="l370"></a><span id="l370">	<span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#41729" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#41726" title="=&gt; Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span></span>
<a href="l371"></a><span id="l371">	  <a href="#57846" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]" class="delimiter">[</span><a href="#8931" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#41726" title="=&gt; Array[AnyRef]">buf</a><span class="delimiter">)</span></span>
<a href="l372"></a><span id="l372">	<span class="keyword">else</span></span>
<a href="l373"></a><span id="l373">	  <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41733" title="()scales.utils.ImmutableArray[A]">result</a></span>
<a href="l374"></a><span id="l374">    <span class="delimiter">}</span></span>
<a href="l375"></a><span id="l375"></span>
<a href="l376"></a><span id="l376">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(xs: TraversableOnce[A])ImmutableArrayProxyBuilder.this.type" id="44404">++=</a><span class="delimiter">(</span><a title="TraversableOnce[A]" id="46988">xs</a>: <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span></span>
<a href="l377"></a><span id="l377">    <span class="comment">// if its already a vector don't start with arrays again</span></span>
<a href="l378"></a><span id="l378">    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#44398" title="=&gt; Boolean">haveChosen</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#46988" title="TraversableOnce[A]">xs</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#57814" title="scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l379"></a><span id="l379">      <a href="#44395" title="(x$1: Boolean)Unit">inVector</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l380"></a><span id="l380">      <a href="#44398" title="(x$1: Boolean)Unit">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span></span>
<a href="l381"></a><span id="l381">    <span class="delimiter">}</span></span>
<a href="l382"></a><span id="l382">    </span>
<a href="l383"></a><span id="l383">    <a href="#46988" title="TraversableOnce[A]">xs</a> <span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def companion: scala.collection.generic.GenericCompanion[IndexedSeq[Any]]; def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">match</span> <span class="delimiter">{</span></span>
<a href="l384"></a><span id="l384">      <span class="keyword">case</span> <a title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def companion: scala.collection.generic.GenericCompanion[IndexedSeq[Any]]; def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" id="47030">p</a> : <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; </span>
<a href="l385"></a><span id="l385">	<span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def companion: scala.collection.generic.GenericCompanion[IndexedSeq[Any]]; def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">if</span> <span class="delimiter">(</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span> </span>
<a href="l386"></a><span id="l386">	  <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])ImmutableArrayProxyBuilder.this.vectorBuilder.type">++=</span><span class="delimiter">(</span><a href="#47030" title="scales.utils.ImmutableArrayProxy[A]">p</a>.<a href="#41740" title="=&gt; TraversableOnce[A]">ar</a><span class="delimiter">)</span> </span>
<a href="l387"></a><span id="l387">	<span class="keyword">else</span></span>
<a href="l388"></a><span id="l388">	  <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41734" title="(xs: TraversableOnce[A])ImmutableArrayProxyBuilder.this.arrayBuilder.type">++=</a><span class="delimiter">(</span><a href="#47030" title="scales.utils.ImmutableArrayProxy[A]">p</a>.<a href="#41740" title="=&gt; TraversableOnce[A]">ar</a><span class="delimiter">)</span></span>
<a href="l389"></a><span id="l389">      <span class="keyword">case</span> <span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def companion: scala.collection.generic.GenericCompanion[IndexedSeq[Any]]; def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]">_</span> =&gt; </span>
<a href="l390"></a><span id="l390">	<span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def companion: scala.collection.generic.GenericCompanion[IndexedSeq[Any]]; def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">if</span> <span class="delimiter">(</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span></span>
<a href="l391"></a><span id="l391">	  <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])ImmutableArrayProxyBuilder.this.vectorBuilder.type">++=</span><span class="delimiter">(</span><a href="#46988" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span></span>
<a href="l392"></a><span id="l392">	<span class="keyword">else</span></span>
<a href="l393"></a><span id="l393">	  <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41734" title="(xs: TraversableOnce[A])ImmutableArrayProxyBuilder.this.arrayBuilder.type">++=</a><span class="delimiter">(</span><a href="#46988" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span></span>
<a href="l394"></a><span id="l394">    <span class="delimiter">}</span>      </span>
<a href="l395"></a><span id="l395"></span>
<a href="l396"></a><span id="l396">    <a href="#44401" title="()Unit">checkVB</a></span>
<a href="l397"></a><span id="l397">    <a href="#56805" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a></span>
<a href="l398"></a><span id="l398">  <span class="delimiter">}</span></span>
<a href="l399"></a><span id="l399"></span>
<a href="l400"></a><span id="l400">  <span class="keyword">def</span> <a title="(elem: A)ImmutableArrayProxyBuilder.this.type" id="44405">+=</a><span class="delimiter">(</span> <a title="A" id="56752">elem</a> : <a href="#8931" title="A">A</a><span class="delimiter">)</span> : <span class="keyword">this</span>.<span class="keyword">type</span> =</span>
<a href="l401"></a><span id="l401">    <span title="ImmutableArrayProxyBuilder.this.type" class="keyword">if</span> <span class="delimiter">(</span><a href="#44395" title="=&gt; Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l402"></a><span id="l402">      <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(elem: A)ImmutableArrayProxyBuilder.this.vectorBuilder.type">+=</span><span class="delimiter">(</span><a href="#56752" title="A">elem</a><span class="delimiter">)</span></span>
<a href="l403"></a><span id="l403">      <a href="#56805" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a></span>
<a href="l404"></a><span id="l404">    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span></span>
<a href="l405"></a><span id="l405">      <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41735" title="(elem: A)ImmutableArrayProxyBuilder.this.arrayBuilder.type">+=</a><span class="delimiter">(</span><a href="#56752" title="A">elem</a><span class="delimiter">)</span></span>
<a href="l406"></a><span id="l406">      <a href="#44401" title="()Unit">checkVB</a></span>
<a href="l407"></a><span id="l407">      <a href="#56805" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a></span>
<a href="l408"></a><span id="l408">    <span class="delimiter">}</span></span>
<a href="l409"></a><span id="l409"></span>
<a href="l410"></a><span id="l410">  <span class="keyword">def</span> <a title="()Unit" id="44406">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span></span>
<a href="l411"></a><span id="l411">    <a href="#44392" title="=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="()Unit">clear</span></span>
<a href="l412"></a><span id="l412">    <a href="#44390" title="=&gt; scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#41736" title="()Unit">clear</a></span>
<a href="l413"></a><span id="l413">    <a href="#44395" title="(x$1: Boolean)Unit">inVector</a> = <span title="Boolean(false)" class="keyword">false</span></span>
<a href="l414"></a><span id="l414">    <a href="#44398" title="(x$1: Boolean)Unit">haveChosen</a> = <span title="Boolean(false)" class="keyword">false</span></span>
<a href="l415"></a><span id="l415">  <span class="delimiter">}</span></span>
<a href="l416"></a><span id="l416"><span class="delimiter">}</span></span>
<a href="l417"></a><span id="l417"></span>
<a href="l418"></a><span id="l418"><span class="comment">/**</span>
<a href="l419"></a><span id="l419"> * Wraps behaviour of ImmutableArray like objects, when the array is greater than 31 it will be swapped to Vector.</span>
<a href="l420"></a><span id="l420"> *</span>
<a href="l421"></a><span id="l421"> */</span> </span>
<a href="l422"></a><span id="l422"><span class="keyword">trait</span> <a title="trait ImmutableArrayProxy[+A] extends java.lang.Object with IndexedSeq[A] with scala.collection.IndexedSeqOptimized[A,scales.utils.ImmutableArrayProxy[A]] with scala.collection.generic.GenericTraversableTemplate[A,scales.utils.ImmutableArrayProxy] with ScalaObject" id="8932">ImmutableArrayProxy</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="8933">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <span title="IndexedSeq[A]">IndexedSeq</span><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.IndexedSeqOptimized[A,scales.utils.ImmutableArrayProxy[A]]">IndexedSeqOptimized</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.generic.GenericTraversableTemplate[A,scales.utils.ImmutableArrayProxy]">GenericTraversableTemplate</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l423"></a><span id="l423"></span>
<a href="l424"></a><span id="l424">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.generic.GenericCompanion[scales.utils.ImmutableArrayProxy]" id="41738">companion</a>: <span title="scala.collection.generic.GenericCompanion[scales.utils.ImmutableArrayProxy]">GenericCompanion</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">]</span> = <a href="#8926" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a></span>
<a href="l425"></a><span id="l425"></span>
<a href="l426"></a><span id="l426">  <span class="keyword">override</span> <span class="keyword">protected</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" id="41739">newBuilder</a>: <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#8926" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a>.<a href="#43754" title="[A]=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">newBuilder</a><span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" class="delimiter">[</span><a href="#8933" title="A">A</a><span class="delimiter">]</span></span>
<a href="l427"></a><span id="l427"></span>
<a href="l428"></a><span id="l428">  <span class="keyword">def</span> <a title="=&gt; TraversableOnce[A]" id="41740">ar</a> : <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span></span>
<a href="l429"></a><span id="l429"> </span>
<a href="l430"></a><span id="l430"><span class="delimiter">}</span></span>
<a href="l431"></a><span id="l431"></span>
<a href="l432"></a><span id="l432"><span class="comment">/**</span>
<a href="l433"></a><span id="l433"> * Proxy Vector.  When its in Vector it stays in Vector. </span>
<a href="l434"></a><span id="l434"> */</span> </span>
<a href="l435"></a><span id="l435">case <span class="keyword">class</span> <a title="class VectorImpl[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="57814">VectorImpl</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="46725">A</a> <span class="delimiter">]</span><a href="#57814" title="ScalaObject" class="delimiter">(</a><a title="Vector[A]" id="46760">ar</a> : <span title="Vector[A]">Vector</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#8932" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span></span>
<a href="l436"></a><span id="l436"></span>
<a href="l437"></a><span id="l437">  <span class="keyword">def</span> <a title="(idx: Int)A" id="46730">apply</a><span class="delimiter">(</span><a title="Int" id="56822">idx</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(index: Int)A">apply</span><span class="delimiter">(</span><a href="#56822" title="Int">idx</a><span class="delimiter">)</span></span>
<a href="l438"></a><span id="l438"> </span>
<a href="l439"></a><span id="l439">  <span class="keyword">def</span> <a title="=&gt; Int" id="46731">length</a> = <a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="=&gt; Int">length</span></span>
<a href="l440"></a><span id="l440">  </span>
<a href="l441"></a><span id="l441">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="46732">+:</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="46735">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="46736">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="56839">elem</a>: <a href="#46735" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="56840">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#46736" title="That">That</a> = <a href="#57814" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">+:</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#56839" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#46736" title="That">That</a><span class="delimiter">]</span></span>
<a href="l442"></a><span id="l442">  </span>
<a href="l443"></a><span id="l443">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="46737">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="46740">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="46741">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="57422">elem</a>: <a href="#46740" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="57423">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#46741" title="That">That</a> = <a href="#57814" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">:+</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#57422" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#46741" title="That">That</a><span class="delimiter">]</span></span>
<a href="l444"></a><span id="l444"></span>
<a href="l445"></a><span id="l445">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.VectorImpl[A]" id="46742">take</a><span class="delimiter">(</span> <a title="Int" id="57529">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#57814" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(n: Int)scala.collection.immutable.Vector[A]">take</span><span class="delimiter">(</span><a href="#57529" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l446"></a><span id="l446"></span>
<a href="l447"></a><span id="l447">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.VectorImpl[A]" id="46743">drop</a><span class="delimiter">(</span> <a title="Int" id="57555">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#57814" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(n: Int)scala.collection.immutable.Vector[A]">drop</span><span class="delimiter">(</span><a href="#57555" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l448"></a><span id="l448"></span>
<a href="l449"></a><span id="l449">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scales.utils.VectorImpl[A]" id="46744">tail</a> = <a href="#57814" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="=&gt; scala.collection.immutable.Vector[A]">tail</span><span class="delimiter">)</span></span>
<a href="l450"></a><span id="l450"></span>
<a href="l451"></a><span id="l451">  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(from: Int, until: Int)scales.utils.VectorImpl[A]" id="46745">slice</a><span class="delimiter">(</span><a title="Int" id="57594">from</a>: <span title="Int">Int</span>, <a title="Int" id="57595">until</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#57814" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(from: Int, until: Int)scala.collection.immutable.Vector[A]">slice</span><span class="delimiter">(</span><a href="#57594" title="Int">from</a>, <a href="#57595" title="Int">until</a><span class="delimiter">)</span><span class="delimiter">)</span></span>
<a href="l452"></a><span id="l452"></span>
<a href="l453"></a><span id="l453">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="46746">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="46749">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="46750">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="57615">index</a>: <span title="Int">Int</span>, <a title="B" id="57616">elem</a>: <a href="#46749" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="57617">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#46750" title="That">That</a> = <a href="#57814" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#46760" title="=&gt; Vector[A]">ar</a>.<span title="(index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">updated</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#57615" title="Int">index</a>, <a href="#57616" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#46750" title="That">That</a><span class="delimiter">]</span></span>
<a href="l454"></a><span id="l454"></span>
<a href="l455"></a><span id="l455">  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[U &gt;: A](implicit evidence$2: ClassManifest[U])Array[U]" id="57734">toArray</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="46753">U</a> &gt;: A : ClassManifest<span class="delimiter">]</span>: <span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span> = <a href="#46760" title="=&gt; Vector[A]">ar</a>.<a href="#57734" title="(implicit evidence$1: ClassManifest[U])Array[U]">toArray</a></span>
<a href="l456"></a><span id="l456"></span>
<a href="l457"></a><span id="l457"><span class="delimiter">}</span></span>
<a href="l458"></a><span id="l458"></span>
<a href="l459"></a><span id="l459"></span>
<a href="l460"></a><span id="l460">        </span>
</pre>
    </body>
</html>