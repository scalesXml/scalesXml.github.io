<table class="classes"><tbody><tr>
      <td class="barContainerLeft"><a href="#">&#x200B;scales/&#x200B;xml/<span class="header">&#x200B;XmlDSL.scala</span></a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">93 %</div>
        <div class="greenBar" style="width:186px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Object_scales_xml_$less"><img src="object.png"></img>$less</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">100 %</div>
        <div class="greenBar" style="width:200px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Class_scales_xml_DslBuilder"><img src="class.png"></img>DslBuilder</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">90 %</div>
        <div class="greenBar" style="width:180px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Object_scales_xml_DslBuilder"><img src="object.png"></img>DslBuilder</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">100 %</div>
        <div class="greenBar" style="width:200px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Class_scales_xml_DslImplicits"><img src="class.png"></img>DslImplicits</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">0 %</div>
        <div class="greenBar" style="width:0px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Trait_scales_xml_DslImplicits"><img src="trait.png"></img>DslImplicits</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">100 %</div>
        <div class="greenBar" style="width:200px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Class_scales_xml_DslImplicits_QNameMatcher"><img src="class.png"></img>DslImplicits.QNameMatcher</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">100 %</div>
        <div class="greenBar" style="width:200px;">&nbsp;</div>
      </div>
    </div></td>
    </tr><tr>
      <td class="barContainerLeft"><a href="src-src_main_scala_scales_xml_XmlDSL.scala.html#Trait_scales_xml_XPathMatcher"><img src="trait.png"></img>XPathMatcher</a></td>
      <td class="barContainerRight"><div class="percentages">
      <div class="bar">
        <div class="percentage">100 %</div>
        <div class="greenBar" style="width:200px;">&nbsp;</div>
      </div>
    </div></td>
    </tr></tbody></table><table class="source"><tbody><tr>
            <td class="black">1</td>
            <td>package scales.xml
</td>
          </tr><tr>
            <td class="black">2</td>
            <td>
</td>
          </tr><tr>
            <td class="black">3</td>
            <td>import scales.utils._
</td>
          </tr><tr>
            <td class="black">4</td>
            <td>
</td>
          </tr><tr>
            <td class="black">5</td>
            <td>import ScalesXml.xmlCBF
</td>
          </tr><tr>
            <td class="black">6</td>
            <td>
</td>
          </tr><tr>
            <td class="black">7</td>
            <td>import ScalesXml.fromParserDefault // note cannot be in parser here
</td>
          </tr><tr>
            <td class="black">8</td>
            <td>
</td>
          </tr><tr>
            <td class="black">9</td>
            <td><a id="Trait_scales_xml_DslImplicits"></a>trait DslImplicits {
</td>
          </tr><tr>
            <td class="black">10</td>
            <td>  import ScalesXml._
</td>
          </tr><tr>
            <td class="green">11</td>
            <td>  implicit def fromElemToBuilder(elem : Elem) = &lt;(elem)
</td>
          </tr><tr>
            <td class="green">12</td>
            <td>  implicit def fromQNamePairToAttribute(pair : (PrefixedQName, String)) = Attribute(pair._1, pair._2)
</td>
          </tr><tr>
            <td class="black">13</td>
            <td>
</td>
          </tr><tr>
            <td class="green">14</td>
            <td>  implicit def fromDslBuilderToTree(dslB : DslBuilder) = dslB.toTree
</td>
          </tr><tr>
            <td class="black">15</td>
            <td>  
</td>
          </tr><tr>
            <td class="black">16</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">17</td>
            <td>   * Only works for elems, allows simpler definitions
</td>
          </tr><tr>
            <td class="black">18</td>
            <td>   */
</td>
          </tr><tr>
            <td class="green">19</td>
            <td>  implicit def fromQNameToTree( qname : QName) = DslBuilder.q2tree(qname)
</td>
          </tr><tr>
            <td class="black">20</td>
            <td>
</td>
          </tr><tr>
            <td class="black">21</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">22</td>
            <td>   * Only works for elems, allows simpler definitions.  Not sure of its usefulness outside of tests though
</td>
          </tr><tr>
            <td class="black">23</td>
            <td>  implicit def fromQNameToItemOrTree( qname : QName) : ItemOrElem = DslBuilder.q2tree(qname)//Right()
</td>
          </tr><tr>
            <td class="black">24</td>
            <td>   */
</td>
          </tr><tr>
            <td class="black">25</td>
            <td>
</td>
          </tr><tr>
            <td class="black">26</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">27</td>
            <td>   * Only works for elems, better looking than &lt;
</td>
          </tr><tr>
            <td class="black">28</td>
            <td>   */
</td>
          </tr><tr>
            <td class="green">29</td>
            <td>  implicit def fromQNameToBuilder( qname : QName) = &lt;(qname)
</td>
          </tr><tr>
            <td class="black">30</td>
            <td>
</td>
          </tr><tr>
            <td class="green">31</td>
            <td><a id="Class_scales_xml_DslImplicits_QNameMatcher"></a>  class QNameMatcher(qname : QName) {
</td>
          </tr><tr>
            <td class="black">32</td>
            <td>    import ScalesXml._
</td>
          </tr><tr>
            <td class="green">33</td>
            <td>    def unapply( elem : Elem ) : Option[Elem] = if (elem.name =:= qname) Some(elem) else None
</td>
          </tr><tr>
            <td class="green">34</td>
            <td>    def unapply( attrib : Attribute ) : Option[Attribute] = if (toQName(attrib.name) =:= qname) Some(attrib) else None
</td>
          </tr><tr>
            <td class="black">35</td>
            <td>  }
</td>
          </tr><tr>
            <td class="black">36</td>
            <td>
</td>
          </tr><tr>
            <td class="black">37</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">38</td>
            <td>   * matches elements and attributes based on qname only
</td>
          </tr><tr>
            <td class="black">39</td>
            <td>   */
</td>
          </tr><tr>
            <td class="green">40</td>
            <td><a id="Class_scales_xml_DslImplicits"></a>  implicit def fromQNameToQNameMatcher( qname : QName) = new {
</td>
          </tr><tr>
            <td class="black">41</td>
            <td>    def m = new QNameMatcher(qname)
</td>
          </tr><tr>
            <td class="black">42</td>
            <td>    def matcher = m
</td>
          </tr><tr>
            <td class="black">43</td>
            <td>  }
</td>
          </tr><tr>
            <td class="black">44</td>
            <td>
</td>
          </tr><tr>
            <td class="green">45</td>
            <td>  implicit def fromTreeToDsl( tree: XmlTree ) = DslBuilder(tree)
</td>
          </tr><tr>
            <td class="black">46</td>
            <td>
</td>
          </tr><tr>
            <td class="black">47</td>
            <td>}
</td>
          </tr><tr>
            <td class="black">48</td>
            <td>
</td>
          </tr><tr>
            <td class="black">49</td>
            <td><a id="Trait_scales_xml_XPathMatcher"></a>trait XPathMatcher {
</td>
          </tr><tr>
            <td class="black">50</td>
            <td>
</td>
          </tr><tr>
            <td class="black">51</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">52</td>
            <td>   * Wrap xpaths into matches, gives back the resulting path if its non empty
</td>
          </tr><tr>
            <td class="black">53</td>
            <td>   */ 
</td>
          </tr><tr>
            <td class="green">54</td>
            <td>  def pathMatcher[T : AsBoolean]( pathEval : (XmlTree) =&gt; T ) = booleanMatcher[XmlTree, T](pathEval)
</td>
          </tr><tr>
            <td class="black">55</td>
            <td>
</td>
          </tr><tr>
            <td class="black">56</td>
            <td>  
</td>
          </tr><tr>
            <td class="black">57</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">58</td>
            <td>   * Wrap xpaths into matches, gives back the resulting path if its non empty
</td>
          </tr><tr>
            <td class="black">59</td>
            <td>   * and the tree that matched it (doesn't force the user to create a val name beforehand)
</td>
          </tr><tr>
            <td class="black">60</td>
            <td>   */ 
</td>
          </tr><tr>
            <td class="green">61</td>
            <td>  def pathAndTreeMatcher[T : AsBoolean]( pathEval : (XmlTree) =&gt; T ) = booleanAndTMatcher[XmlTree, T](pathEval)
</td>
          </tr><tr>
            <td class="black">62</td>
            <td>}
</td>
          </tr><tr>
            <td class="black">63</td>
            <td>
</td>
          </tr><tr>
            <td class="black">64</td>
            <td><a id="Object_scales_xml_$less"></a>object &lt; {
</td>
          </tr><tr>
            <td class="green">65</td>
            <td>  def apply(qname : QName) = DslBuilder(Elem(qname))
</td>
          </tr><tr>
            <td class="green">66</td>
            <td>  def apply(elem : Elem) = DslBuilder(elem)
</td>
          </tr><tr>
            <td class="black">67</td>
            <td>}
</td>
          </tr><tr>
            <td class="black">68</td>
            <td>
</td>
          </tr><tr>
            <td class="black">69</td>
            <td><a id="Object_scales_xml_DslBuilder"></a>protected[xml] object DslBuilder {
</td>
          </tr><tr>
            <td class="green">70</td>
            <td>  def elem2tree( elem : Elem ) : XmlTree = subtree[XmlItem, Elem, XCC](elem,emptyChildren).right.get
</td>
          </tr><tr>
            <td class="green">71</td>
            <td>  def q2tree( qname : QName ) = elem2tree(Elem(qname))
</td>
          </tr><tr>
            <td class="green">72</td>
            <td>  def apply( elem : Elem ) = new DslBuilder(elem2tree(elem))
</td>
          </tr><tr>
            <td class="green">73</td>
            <td>  def apply( tree : XmlTree ) = new DslBuilder(tree)
</td>
          </tr><tr>
            <td class="black">74</td>
            <td>}
</td>
          </tr><tr>
            <td class="black">75</td>
            <td>
</td>
          </tr><tr>
            <td class="black">76</td>
            <td>/*
</td>
          </tr><tr>
            <td class="black">77</td>
            <td> * Must have a starting element, modelled as tree as we need to keep the data around and trees must always have an elem
</td>
          </tr><tr>
            <td class="black">78</td>
            <td> */
</td>
          </tr><tr>
            <td class="green">79</td>
            <td><a id="Class_scales_xml_DslBuilder"></a>class DslBuilder private( tree : XmlTree ) {
</td>
          </tr><tr>
            <td class="black">80</td>
            <td>  import ScalesXml._
</td>
          </tr><tr>
            <td class="black">81</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">82</td>
            <td>   * Add attributes
</td>
          </tr><tr>
            <td class="black">83</td>
            <td>  */ 
</td>
          </tr><tr>
            <td class="green">84</td>
            <td>  def /@(attribs : Attribute*) = new DslBuilder( tree.copy(section = tree.section.copy (attributes = tree.section.attributes ++ attribs) ))
</td>
          </tr><tr>
            <td class="black">85</td>
            <td>
</td>
          </tr><tr>
            <td class="black">86</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">87</td>
            <td>   * Remove attributes
</td>
          </tr><tr>
            <td class="black">88</td>
            <td>   */
</td>
          </tr><tr>
            <td class="green">89</td>
            <td>  def -/@(attribs : QName*) = new DslBuilder( tree.copy(section = tree.section.copy (attributes = tree.section.attributes -- attribs)))
</td>
          </tr><tr>
            <td class="black">90</td>
            <td>  
</td>
          </tr><tr>
            <td class="black">91</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">92</td>
            <td>   * Add a number of child elements (as trees).  Via the implicit DslBuilders can then be embedded
</td>
          </tr><tr>
            <td class="black">93</td>
            <td>   */
</td>
          </tr><tr>
            <td class="black">94</td>
            <td>  def /( elems : XmlTree * ) : DslBuilder = 
</td>
          </tr><tr>
            <td class="green">95</td>
            <td>    /(elems)
</td>
          </tr><tr>
            <td class="black">96</td>
            <td>
</td>
          </tr><tr>
            <td class="red">97</td>
            <td>  def add( elems : XmlTree * ) = <span class="non">/( elems :_* )
</span></td>
          </tr><tr>
            <td class="black">98</td>
            <td>
</td>
          </tr><tr>
            <td class="black">99</td>
            <td>  def /( elems : =&gt; Iterable[XmlTree] ) : DslBuilder =
</td>
          </tr><tr>
            <td class="green">100</td>
            <td>    new DslBuilder( tree.copy( children = (tree.children ++ elems/*++ elems.map(Right(_))*/  )))
</td>
          </tr><tr>
            <td class="black">101</td>
            <td>
</td>
          </tr><tr>
            <td class="black">102</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">103</td>
            <td>   * any qname will do given its elems
</td>
          </tr><tr>
            <td class="black">104</td>
            <td>   */
</td>
          </tr><tr>
            <td class="green">105</td>
            <td>  def -/( qname : QName ) = new DslBuilder(tree.copy(children = tree.children.filterNot{
</td>
          </tr><tr>
            <td class="black">106</td>
            <td>    either =&gt;
</td>
          </tr><tr>
            <td class="yellow">107</td>
            <td>      either.fold( item =&gt; <span class="non">false, tree =&gt; </span>tree.section.name =:= qname)
</td>
          </tr><tr>
            <td class="black">108</td>
            <td>  }))
</td>
          </tr><tr>
            <td class="black">109</td>
            <td>
</td>
          </tr><tr>
            <td class="black">110</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">111</td>
            <td>   * Add a number of xmlITems, text, cdata, comments etc, the two params is to get around /(Seq) erasures.
</td>
          </tr><tr>
            <td class="black">112</td>
            <td>   */
</td>
          </tr><tr>
            <td class="black">113</td>
            <td>  def /( item1 : XmlItem, items: XmlItem * ) = 
</td>
          </tr><tr>
            <td class="green">114</td>
            <td>    new DslBuilder( tree.copy( children = (tree.children :+ item[XmlItem, Elem, XCC](item1)) ++ items/*.map(item[XmlItem, Elem, XCC](_))*/  ))
</td>
          </tr><tr>
            <td class="black">115</td>
            <td>
</td>
          </tr><tr>
            <td class="black">116</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">117</td>
            <td>   * sets the tree to a single Text node child, replacing all others
</td>
          </tr><tr>
            <td class="black">118</td>
            <td>   */
</td>
          </tr><tr>
            <td class="black">119</td>
            <td>  def ~&gt;( value : String ) = // note ~&gt; is used not -&gt; as it will then get in the way of the tupler
</td>
          </tr><tr>
            <td class="green">120</td>
            <td>    new DslBuilder( tree.copy(children = emptyChildren :+ item[XmlItem, Elem, XCC](Text(value))))
</td>
          </tr><tr>
            <td class="black">121</td>
            <td>  
</td>
          </tr><tr>
            <td class="black">122</td>
            <td>  /**
</td>
          </tr><tr>
            <td class="black">123</td>
            <td>   * Cleans out any child text nodes (comments, cdata etc) and just leaves child elements
</td>
          </tr><tr>
            <td class="black">124</td>
            <td>   */
</td>
          </tr><tr>
            <td class="yellow">125</td>
            <td>  def elementsOnly = new DslBuilder(tree.copy(children = tree.children.filter( _.fold( _ =&gt; <span class="non">false, _ =&gt; true ) ) ))
</span></td>
          </tr><tr>
            <td class="black">126</td>
            <td>
</td>
          </tr><tr>
            <td class="green">127</td>
            <td>  def toTree = tree
</td>
          </tr><tr>
            <td class="black">128</td>
            <td>
</td>
          </tr><tr>
            <td class="black">129</td>
            <td>}
</td>
          </tr></tbody></table>