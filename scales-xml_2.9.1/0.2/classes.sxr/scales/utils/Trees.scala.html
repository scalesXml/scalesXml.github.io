<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scales\utils\Trees.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    
<style id="linesStyle">
.lineHighlight {
  background-color: #a5a5a5;
}
</style>
<script type="text/javascript">
function selectedLine() {
    var loca = /^.*#l(.*)/.exec(location.href);
    return loca ? loca[1] : '0';
}

function highlightLine(ln){
  $('#l'+ln).toggleClass('lineHighlight');
}

function gotoLine(ln){
  $('#l'+ln).focus();
}

$(function(){
  var line = selectedLine();
  if (line != '0') highlightLine(line)
});
</script></head>
    <body>
        <pre>
<!-- SXR_LINES --><a href="l1"></a><span id="l1"><span class="keyword">package</span> scales.utils</span>
<a href="l2"></a><span id="l2"></span>
<a href="l3"></a><span id="l3"><span class="keyword">import</span> scala.collection.IndexedSeqLike</span>
<a href="l4"></a><span id="l4"><span class="keyword">import</span> scala.collection.generic.CanBuildFrom</span>
<a href="l5"></a><span id="l5"></span>
<a href="l6"></a><span id="l6"><span class="keyword">trait</span> <a title="trait Trees extends java.lang.Object with ScalaObject" id="10650">Trees</a> <span title="ScalaObject" class="delimiter">{</span></span>
<a href="l7"></a><span id="l7"></span>
<a href="l8"></a><span id="l8">  <span class="keyword">type</span> <a title="[Item &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]], Section, CC[X] &lt;: scala.collection.IndexedSeqLike[X,CC[X]]]scales.utils.EitherLike[Item,scales.utils.Tree[Item,Section,CC]]" id="12183">ItemOrTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]]" id="12184">Item</a> &lt;: LeftLike<span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="12185">Section</a>, <a title="[X]&gt;: Nothing &lt;: scala.collection.IndexedSeqLike[X,CC[X]]" id="12186">CC</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="67489">X</a><span class="delimiter">]</span> &lt;: IndexedSeqLike<span class="delimiter">[</span>X, CC<span class="delimiter">[</span>X<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> = <a href="EitherLike.scala.html#10328" title="scales.utils.EitherLike[Item,scales.utils.Tree[Item,Section,CC]]">EitherLike</a><span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l9"></a><span id="l9"></span>
<a href="l10"></a><span id="l10">  <span class="comment">/** badly named the boolean should indicate if it has any children */</span></span>
<a href="l11"></a><span id="l11">  <span class="keyword">type</span> <a title="[Item, Section]Either[Item,scales.utils.SectionWalk[Section]]" id="12187">ItemOrSectionWalk</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="12188">Item</a>, <a title="&gt;: Nothing &lt;: Any" id="12189">Section</a><span class="delimiter">]</span> = <span title="Either[Item,scales.utils.SectionWalk[Section]]">Either</span><span class="delimiter">[</span>Item, SectionWalk<span class="delimiter">[</span>Section<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l12"></a><span id="l12"></span>
<a href="l13"></a><span id="l13">  <span class="keyword">type</span> <a title="[Item &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]], Section, CC[X] &lt;: scala.collection.IndexedSeqLike[X,CC[X]]]scala.collection.generic.CanBuildFrom[CC[_],Trees.this.ItemOrTree[Item,Section,CC],CC[Trees.this.ItemOrTree[Item,Section,CC]]]" id="12190">TreeCBF</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]]" id="12191">Item</a> &lt;: LeftLike<span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="12192">Section</a>, <a title="[X]&gt;: Nothing &lt;: scala.collection.IndexedSeqLike[X,CC[X]]" id="12193">CC</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="79523">X</a><span class="delimiter">]</span> &lt;: IndexedSeqLike<span class="delimiter">[</span>X, CC<span class="delimiter">[</span>X<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span> = <span title="scala.collection.generic.CanBuildFrom[CC[_],Trees.this.ItemOrTree[Item,Section,CC],CC[Trees.this.ItemOrTree[Item,Section,CC]]]">CanBuildFrom</span><span class="delimiter">[</span>CC<span class="delimiter">[</span>_<span class="delimiter">]</span>, ItemOrTree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span>, CC<span class="delimiter">[</span>ItemOrTree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l14"></a><span id="l14"></span>
<a href="l15"></a><span id="l15">  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[Item &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]], Section, CC[X] &lt;: scala.collection.IndexedSeqLike[X,CC[X]], A](a: A)(folder: (Trees.this.ItemOrSectionWalk[Item,Section], A) =&gt; A)(tree: scales.utils.Tree[Item,Section,CC])A" id="12194">fold</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]]" id="12199">Item</a> &lt;: LeftLike<span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="12200">Section</a>, <a title="[X]&gt;: Nothing &lt;: scala.collection.IndexedSeqLike[X,CC[X]]" id="12201">CC</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="87390">X</a><span class="delimiter">]</span> &lt;: IndexedSeqLike<span class="delimiter">[</span>X, CC<span class="delimiter">[</span>X<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="12202">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="87386">a</a>: <a href="#12202" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(Trees.this.ItemOrSectionWalk[Item,Section], A) =&gt; A" id="87387">folder</a>: <span class="delimiter">(</span>ItemOrSectionWalk<span class="delimiter">[</span>Item, Section<span class="delimiter">]</span>, A<span class="delimiter">)</span> =&gt; A<span class="delimiter">)</span><span class="delimiter">(</span><a title="scales.utils.Tree[Item,Section,CC]" id="87388">tree</a>: <a href="#87725" title="scales.utils.Tree[Item,Section,CC]">Tree</a><span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#12202" title="A">A</a> =</span>
<a href="l16"></a><span id="l16">    <a href="#87388" title="scales.utils.Tree[Item,Section,CC]">tree</a>.<a href="#67499" title="(a: A)(folder: (scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A)A">fold</a><span class="delimiter">(</span><a href="#87386" title="A">a</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#87387" title="(Trees.this.ItemOrSectionWalk[Item,Section], A) =&gt; A">folder</a><span class="delimiter">)</span></span>
<a href="l17"></a><span id="l17"></span>
<a href="l18"></a><span id="l18"><span class="delimiter">}</span></span>
<a href="l19"></a><span id="l19"></span>
<a href="l20"></a><span id="l20"><span class="comment">/**</span>
<a href="l21"></a><span id="l21"> * IF hasChildren then isStart indicates that this particular occurence</span>
<a href="l22"></a><span id="l22"> * is the start of the element or the end</span>
<a href="l23"></a><span id="l23"> *</span>
<a href="l24"></a><span id="l24"> * @author Chris</span>
<a href="l25"></a><span id="l25"> *</span>
<a href="l26"></a><span id="l26"> */</span></span>
<a href="l27"></a><span id="l27">case <span class="keyword">class</span> <a title="class SectionWalk[Section] extends java.lang.Object with ScalaObject with Product with Serializable" id="87736">SectionWalk</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="87450">Section</a><span class="delimiter">]</span><a href="#87736" title="ScalaObject" class="delimiter">(</a><a title="Section" id="87586">section</a>: <a href="#87450" title="Section">Section</a>, <a title="Boolean" id="87587">hasChildren</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span>, <a title="Boolean" id="87588">isStart</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span></span>
<a href="l28"></a><span id="l28"></span>
<a href="l29"></a><span id="l29">case <span class="keyword">class</span> <a title="class Tree[Item &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]], Section, CC[C] &lt;: scala.collection.IndexedSeqLike[C,CC[C]]] extends java.lang.Object with scales.utils.RightLike[Item,scales.utils.Tree[Item,Section,CC]] with ScalaObject with Product with Serializable" id="87725">Tree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: scales.utils.LeftLike[Item,scales.utils.Tree[Item,Section,CC]]" id="80179">Item</a> &lt;: LeftLike<span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="80180">Section</a>, <a title="[C]&gt;: Nothing &lt;: scala.collection.IndexedSeqLike[C,CC[C]]" id="80181">CC</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="83320">C</a><span class="delimiter">]</span> &lt;: IndexedSeqLike<span class="delimiter">[</span>C, CC<span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><a href="#87725" title="ScalaObject" class="delimiter">(</a><a title="Section" id="83318">section</a>: <a href="#80180" title="Section">Section</a>, <a title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]" id="83319">children</a>: <a href="#80181" title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]">CC</a><span class="delimiter">[</span>ItemOrTree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="EitherLike.scala.html#10334" title="scales.utils.RightLike[Item,scales.utils.Tree[Item,Section,CC]]">RightLike</a><span class="delimiter">[</span>Item, Tree<span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">]</span></span>
<a href="l30"></a><span id="l30"><span class="comment">//    (implicit cbf : TreeCBF[Item, Section, CC]) </span></span>
<a href="l31"></a><span id="l31"><span class="delimiter">{</span></span>
<a href="l32"></a><span id="l32">  <span class="keyword">def</span> <a title="[A](a: A)(folder: (scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A)A" id="67499">fold</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="67501">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="87394">a</a>: <a href="#67501" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A" id="87395">folder</a>: <span class="delimiter">(</span>ItemOrSectionWalk<span class="delimiter">[</span>Item, Section<span class="delimiter">]</span>, A<span class="delimiter">)</span> =&gt; A<span class="delimiter">)</span>: <a href="#67501" title="A">A</a> = <span class="delimiter">{</span></span>
<a href="l33"></a><span id="l33">    <span class="comment">// @scala.annotation.tailrec can't optimize</span></span>
<a href="l34"></a><span id="l34">    <span class="keyword">def</span> <a title="(a: A, folder: (scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A, tree: scales.utils.Tree[Item,Section,CC])A" id="87547">ifold</a><span class="delimiter">(</span><a title="A" id="87548">a</a>: <a href="#67501" title="A">A</a>, <a title="(scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A" id="87549">folder</a>: <span class="delimiter">(</span>ItemOrSectionWalk<span class="delimiter">[</span>Item, Section<span class="delimiter">]</span>, A<span class="delimiter">)</span> =&gt; A,</span>
<a href="l35"></a><span id="l35">      <a title="scales.utils.Tree[Item,Section,CC]" id="87550">tree</a>: <a href="#87725" title="scales.utils.Tree[Item,Section,CC]">Tree</a><span class="delimiter">[</span>Item, Section, CC<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#67501" title="A">A</a> =</span>
<a href="l36"></a><span id="l36">      <span class="comment">// match against</span></span>
<a href="l37"></a><span id="l37">      <a href="#87550" title="scales.utils.Tree[Item,Section,CC]">tree</a> <span title="A" class="keyword">match</span> <span class="delimiter">{</span></span>
<a href="l38"></a><span id="l38">        <span class="keyword">case</span> <span title="A">Tree</span><span class="delimiter">(</span><a title="Section" id="87579">top</a>, <a title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]" id="87580">x</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#87580" title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]">x</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> =&gt; <a href="#87549" title="(v1: scales.utils.package.ItemOrSectionWalk[Item,Section], v2: A)A">folder</a><span class="delimiter">(</span><span title="(b: scales.utils.SectionWalk[Section])Right[Nothing,scales.utils.SectionWalk[Section]]">Right</span><span class="delimiter">(</span><a href="#87736" title="(section: Section, hasChildren: Boolean, isStart: Boolean)scales.utils.SectionWalk[Section]">SectionWalk</a><span class="delimiter">(</span><a href="#87579" title="Section">top</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#87548" title="A">a</a><span class="delimiter">)</span></span>
<a href="l39"></a><span id="l39">        <span class="keyword">case</span> <span title="A">Tree</span><span class="delimiter">(</span><a title="Section" id="87615">top</a>, <a title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]" id="87616">children</a><span class="delimiter">)</span> =&gt;</span>
<a href="l40"></a><span id="l40">          <span class="keyword">val</span> <a title="A" id="87617">temp</a> = <a href="#87549" title="(v1: scales.utils.package.ItemOrSectionWalk[Item,Section], v2: A)A">folder</a><span class="delimiter">(</span><span title="(b: scales.utils.SectionWalk[Section])Right[Nothing,scales.utils.SectionWalk[Section]]">Right</span><span class="delimiter">(</span><a href="#87736" title="(section: Section, hasChildren: Boolean, isStart: Boolean)scales.utils.SectionWalk[Section]">SectionWalk</a><span class="delimiter">(</span><a href="#87615" title="Section">top</a>, hasChildren = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#87548" title="A">a</a><span class="delimiter">)</span></span>
<a href="l41"></a><span id="l41">          <span class="keyword">val</span> <a title="A" id="87618">fres</a> = <a href="#87616" title="CC[scales.utils.package.ItemOrTree[Item,Section,CC]]">children</a>.<span title="(z: A)(op: (A, scales.utils.package.ItemOrTree[Item,Section,CC]) =&gt; A)A">foldLeft</span><span class="delimiter">(</span><a href="#87617" title="A">temp</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="A" id="87644">foldeda</a>, <a title="scales.utils.package.ItemOrTree[Item,Section,CC]" id="87645">iort</a><span class="delimiter">)</span> =&gt;</span>
<a href="l42"></a><span id="l42">            <a href="#87645" title="scales.utils.package.ItemOrTree[Item,Section,CC]">iort</a>.<a href="EitherLike.scala.html#39635" title="(fl: Item =&gt; A, fr: scales.utils.Tree[Item,Section,CC] =&gt; A)A">fold</a><span class="delimiter">(</span> </span>
<a href="l43"></a><span id="l43">	      <span class="delimiter">(</span>item : <a href="#80179" title="Item">Item</a><span class="delimiter">)</span> =&gt; <a href="#87549" title="(v1: scales.utils.package.ItemOrSectionWalk[Item,Section], v2: A)A">folder</a><span class="delimiter">(</span><span title="(a: Item)Left[Item,Nothing]">Left</span><span class="delimiter">(</span><a href="#87652" title="Item">item</a><span class="delimiter">)</span>, <a href="#87644" title="A">foldeda</a><span class="delimiter">)</span>, </span>
<a href="l44"></a><span id="l44">	      <span class="delimiter">(</span>rtree : <a href="#87725" title="scales.utils.Tree[Item,Section,CC]">Tree</a><span class="delimiter">[</span>Item,Section,CC<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#87547" title="(a: A, folder: (scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A, tree: scales.utils.Tree[Item,Section,CC])A">ifold</a><span class="delimiter">(</span><a href="#87644" title="A">foldeda</a>, <a href="#87549" title="(scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A">folder</a>, <a href="#87658" title="scales.utils.Tree[Item,Section,CC]">rtree</a><span class="delimiter">)</span></span>
<a href="l45"></a><span id="l45">	    <span class="delimiter">)</span></span>
<a href="l46"></a><span id="l46">	    <span class="comment">/*iort match {</span>
<a href="l47"></a><span id="l47">              case Left(item : Item) =&gt; folder(Left(item), foldeda)</span>
<a href="l48"></a><span id="l48">              // recurse</span>
<a href="l49"></a><span id="l49">              case Right(rtree : Tree[Item,Section,CC]) =&gt; ifold(foldeda, folder, rtree)</span>
<a href="l50"></a><span id="l50">            }*/</span></span>
<a href="l51"></a><span id="l51">          <span class="delimiter">}</span></span>
<a href="l52"></a><span id="l52">          <a href="#87549" title="(v1: scales.utils.package.ItemOrSectionWalk[Item,Section], v2: A)A">folder</a><span class="delimiter">(</span><span title="(b: scales.utils.SectionWalk[Section])Right[Nothing,scales.utils.SectionWalk[Section]]">Right</span><span class="delimiter">(</span><a href="#87736" title="(section: Section, hasChildren: Boolean, isStart: Boolean)scales.utils.SectionWalk[Section]">SectionWalk</a><span class="delimiter">(</span><a href="#87615" title="Section">top</a>, hasChildren = <span title="Boolean(true)" class="keyword">true</span>, isStart = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#87618" title="A">fres</a><span class="delimiter">)</span></span>
<a href="l53"></a><span id="l53">      <span class="delimiter">}</span></span>
<a href="l54"></a><span id="l54">    <a href="#87547" title="(a: A, folder: (scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A, tree: scales.utils.Tree[Item,Section,CC])A">ifold</a><span class="delimiter">(</span><a href="#87394" title="A">a</a>, <a href="#87395" title="(scales.utils.package.ItemOrSectionWalk[Item,Section], A) =&gt; A">folder</a>, <a href="#87725" title="scales.utils.Tree[Item,Section,CC]" class="keyword">this</a><span class="delimiter">)</span></span>
<a href="l55"></a><span id="l55">  <span class="delimiter">}</span></span>
<a href="l56"></a><span id="l56"><span class="delimiter">}</span></span>
<a href="l57"></a><span id="l57"></span>
<a href="l58"></a><span id="l58">        </span>
</pre>
    </body>
</html>