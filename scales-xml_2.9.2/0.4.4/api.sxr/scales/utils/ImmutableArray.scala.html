<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scales\utils\ImmutableArray.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scales.utils

<span class="keyword">import</span> collection.<span class="delimiter">{</span>IndexedSeqOptimized, IndexedSeqLike, IndexedSeq<span class="delimiter">}</span>
<span class="keyword">import</span> collection.mutable.Builder
<span class="keyword">import</span> collection.generic.<span class="delimiter">{</span>CanBuildFrom, GenericTraversableTemplate, SeqFactory, GenericCompanion<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scales.utils.ImmutableArray" id="48375">ImmutableArray</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scales.utils.ImmutableArray[Nothing]" id="48073">emptyImmutableArray</a> = <span title="scales.utils.ImmutableArray[Nothing]" class="keyword">new</span> <a href="#51541" title="scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span><span class="delimiter">(</span><span title="[T](xs: T*)(implicit evidence$2: scala.reflect.ClassManifest[T])Array[T]">Array</span><span title="(xs: AnyRef*)(implicit evidence$2: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><span class="delimiter">)</span>,<span title="Int(0)" class="int">0</span>,<span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Behaves like an ArrayList/ArrayBuffer, growing an internal array as necessary
 */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ImmutableArrayBuilder[A] extends java.lang.Object with scala.collection.mutable.Builder[A,scales.utils.ImmutableArray[A]] with ScalaObject" id="10516">ImmutableArrayBuilder</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="50043">A</a> <span class="delimiter">]</span><a href="#10516" title="ScalaObject" class="delimiter">(</a><span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Array[AnyRef]" id="50041">_buf</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><span title="Int(8)" class="int">8</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArray[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">{</span>

  <span class="keyword">final</span> <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="Float" id="48413">gf</a> : <span title="Float">Float</span> = <span title="Float(2.0)" class="float">2.0f</span>
  <span class="keyword">final</span> <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">val</span> <a title="Float" id="48414">gp</a> : <span title="Float">Float</span>  = <span title="Float(0.95)" class="float">0.95f</span>

  <span class="keyword">def</span> <a title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]" id="48415">resize</a><span class="delimiter">(</span> <a title="Array[AnyRef]" id="50055">orig</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <a title="Int" id="50056">newCapacity</a> : <span title="Int">Int</span>, <a title="Int" id="50057">len</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <span class="delimiter">{</span> 
    <span class="keyword">val</span> <a title="Array[AnyRef]" id="50060">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#50056" title="Int">newCapacity</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50057" title="Int">len</a> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#50055" title="Array[AnyRef]">orig</a>, <span title="Int(0)" class="int">0</span>, <a href="#50060" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#50057" title="Int">len</a><span class="delimiter">)</span>

    <a href="#50060" title="Array[AnyRef]">ar</a>
  <span class="delimiter">}</span>

  
  @inline <span class="keyword">def</span> <a title="=&gt; Array[AnyRef]" id="48416">buf</a> = <a href="#50041" title="Array[AnyRef]">_buf</a>

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Int" id="48417">_len</a> = <span title="Int(0)" class="int">0</span>
  @inline <span class="keyword">def</span> <a title="=&gt; Int" id="48418">len</a> = <a href="#48417" title="Int">_len</a>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="48419">ensureSize</a><span class="delimiter">(</span> <a title="Int" id="50081">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">import</span> java.lang.<span title="object java.lang.Math">Math</span>.round
    
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#50041" title="Array[AnyRef]">_buf</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#50081" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#50041" title="Array[AnyRef]">_buf</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#50041" title="Array[AnyRef]">_buf</a> = <a href="#48415" title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]">resize</a><span class="delimiter">(</span> <a href="#50041" title="Array[AnyRef]">_buf</a>, <a href="#50081" title="Int">size</a>, <a href="#48417" title="Int">_len</a> <span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50081" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <span title="(x$1: Float)Int">round</span><span class="delimiter">(</span><a href="#50041" title="Array[AnyRef]">_buf</a>.<span title="=&gt; Int">length</span> <span title="(x: Float)Float">*</span> <a href="#48414" title="Float">gp</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50041" title="Array[AnyRef]">_buf</a> = <a href="#48415" title="(orig: Array[AnyRef], newCapacity: Int, len: Int)Array[AnyRef]">resize</a><span class="delimiter">(</span> <a href="#50041" title="Array[AnyRef]">_buf</a>, 
	 <span title="(x$1: Float)Int">round</span><span class="delimiter">(</span><a href="#50041" title="Array[AnyRef]">_buf</a>.<span title="=&gt; Int">length</span>.<span title="=&gt; Float">toFloat</span> <span title="(x: Float)Float">*</span> <a href="#48413" title="Float">gf</a><span class="delimiter">)</span>, <a href="#48417" title="Int">_len</a> <span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="48420">sizeHint</a><span class="delimiter">(</span> <a title="Int" id="50241">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#48419" title="(size: Int)Unit">ensureSize</a><span class="delimiter">(</span><a href="#50241" title="Int">size</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()scales.utils.ImmutableArray[A]" id="48421">result</a> : <a href="#51541" title="scales.utils.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = 
    <span title="scales.utils.ImmutableArray[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#48417" title="Int">_len</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#48375" title="object scales.utils.ImmutableArray">ImmutableArray</a>.<a href="#48073" title="=&gt; scales.utils.ImmutableArray[Nothing]">emptyImmutableArray</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scales.utils.ImmutableArray[A]" class="delimiter">[</span><a href="#51541" title="scales.utils.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
    <span class="keyword">else</span>
      <a href="#51541" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#50041" title="Array[AnyRef]">_buf</a>, <span title="Int(0)" class="int">0</span>, <a href="#48417" title="Int">_len</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(xs: TraversableOnce[A])ImmutableArrayBuilder.this.type" id="48422">++=</a><span class="delimiter">(</span><a title="TraversableOnce[A]" id="50252">xs</a>: <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <a href="#50252" title="TraversableOnce[A]">xs</a> <span title="ImmutableArrayBuilder.this.type" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="ImmutableArrayBuilder.this.type">ImmutableArray</span><span class="delimiter">(</span> <a title="Array[AnyRef]" id="50255">base</a>, <a title="Int" id="50256">offset</a>, <a title="Int" id="50257">slen</a><span class="delimiter">)</span> =&gt;
      <a href="#48419" title="(size: Int)Unit">ensureSize</a><span class="delimiter">(</span><a href="#48417" title="Int">_len</a> <span title="(x: Int)Int">+</span> <a href="#50257" title="Int">slen</a><span class="delimiter">)</span>
      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#50255" title="Array[AnyRef]">base</a>, <a href="#50256" title="Int">offset</a>, <a href="#50041" title="Array[AnyRef]">_buf</a>, <a href="#48417" title="Int">_len</a>, <a href="#50257" title="Int">slen</a><span class="delimiter">)</span>
      <a href="#48417" title="Int">_len</a> <span title="(x: Int)Int">+=</span> <a href="#50257" title="Int">slen</a>
      <a href="#10516" title="ImmutableArrayBuilder.this.type" class="keyword">this</a>
    <span class="keyword">case</span> <span title="ImmutableArrayBuilder.this.type">_</span> =&gt;
      <a href="#10516" title="scales.utils.ImmutableArrayBuilder[A]" class="keyword">super</a>.<span title="(xs: scala.collection.TraversableOnce[A])ImmutableArrayBuilder.this.type">++=</span><span class="delimiter">(</span><a href="#50252" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(elem: A)ImmutableArrayBuilder.this.type" id="48423">+=</a><span class="delimiter">(</span> <a title="A" id="50270">elem</a> : <a href="#50043" title="A">A</a><span class="delimiter">)</span> : <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#48419" title="(size: Int)Unit">ensureSize</a><span class="delimiter">(</span><a href="#48417" title="Int">_len</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="comment">// we know its big enough</span>
    <a href="#50041" title="(i: Int, x: AnyRef)Unit">_buf</a><span class="delimiter">(</span><a href="#48417" title="Int">_len</a><span class="delimiter">)</span> = <a href="#50270" title="A">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
    <a href="#48417" title="Int">_len</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <a href="#10516" title="ImmutableArrayBuilder.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="48424">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#48417" title="Int">_len</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a href="#50430" title="class IAEmpty[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="63170">IAEmpty</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="51550">A</a> <span class="delimiter">]</span><a href="#63170" title="ScalaObject" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="50294">length</a> = <span title="Int(0)" class="int">0</span>

  <span class="keyword">def</span> <a title="(idx: Int)Nothing" id="50295">apply</a><span class="delimiter">(</span><a title="Int" id="50335">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <a href="package.scala.html#15432" title="(str: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Can\'t return an item, as we are empty&quot;)" class="string">&quot;Can't return an item, as we are empty&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; scales.utils.IAEmpty[A]" id="50296">ar</a> = <a href="#63170" title="scales.utils.IAEmpty[A]" class="keyword">this</a>  

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50297">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50300">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50301">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="50345">elem</a>: <a href="#50300" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50346">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50301" title="That">That</a> =
    <a href="#63162" title="(one: B)scales.utils.IAOne[B]">IAOne</a><span class="delimiter">(</span><a href="#50345" title="B">elem</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50301" title="That">That</a><span class="delimiter">]</span>

<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class IAOne[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="63162">IAOne</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="50375">A</a> <span class="delimiter">]</span><a href="#63162" title="ScalaObject" class="delimiter">(</a> <a title="A" id="50399">one</a> : <a href="#50375" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(idx: Int)A" id="50380">apply</a><span class="delimiter">(</span><a title="Int" id="50436">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#50399" title="=&gt; A">one</a>

  <span class="keyword">def</span> <a title="=&gt; Int" id="50381">length</a> = <span title="Int(1)" class="int">1</span>

  <span class="keyword">def</span> <a title="=&gt; scales.utils.IAOne[A]" id="50382">ar</a> = <a href="#63162" title="scales.utils.IAOne[A]" class="keyword">this</a>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50383">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50386">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50387">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="50454">elem</a>: <a href="#50386" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50455">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50387" title="That">That</a> =
    <a href="#63105" title="(one: B, two: B)scales.utils.IATwo[B]">IATwo</a><span class="delimiter">(</span><a href="#50399" title="=&gt; A">one</a>, <a href="#50454" title="B">elem</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50387" title="That">That</a><span class="delimiter">]</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50388">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50391">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50392">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="50543">index</a>: <span title="Int">Int</span>, <a title="B" id="50544">elem</a>: <a href="#50391" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50545">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50392" title="That">That</a> =
    <a href="#63162" title="(one: B)scales.utils.IAOne[B]">IAOne</a><span class="delimiter">(</span><a href="#50544" title="B">elem</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50392" title="That">That</a><span class="delimiter">]</span>

<span class="delimiter">}</span>

<span class="keyword">import</span> scala.annotation.switch

case <span class="keyword">class</span> <a title="class IATwo[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="63105">IATwo</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="50484">A</a> <span class="delimiter">]</span><a href="#63105" title="ScalaObject" class="delimiter">(</a> <a title="A" id="50511">one</a> : <a href="#50484" title="A">A</a>, <a title="A" id="50512">two</a> : <a href="#50484" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(idx: Int)A" id="50492">apply</a><span class="delimiter">(</span><a title="Int" id="50601">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#50601" title="Int">idx</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="A" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="IATwo.this.one.type" class="int">0</span> =&gt; <a href="#50511" title="=&gt; A">one</a>
    <span class="keyword">case</span> <span title="IATwo.this.two.type" class="int">1</span> =&gt; <a href="#50512" title="=&gt; A">two</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="50493">length</a> = <span title="Int(2)" class="int">2</span>

  <span class="keyword">def</span> <a title="=&gt; scales.utils.IATwo[A]" id="50494">ar</a> = <a href="#63105" title="scales.utils.IATwo[A]" class="keyword">this</a>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50495">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50498">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50499">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="50620">elem</a>: <a href="#50498" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50621">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50499" title="That">That</a> =
    <a href="#63139" title="(one: B, two: B, three: B)scales.utils.IAThree[B]">IAThree</a><span class="delimiter">(</span><a href="#50511" title="=&gt; A">one</a>, <a href="#50512" title="=&gt; A">two</a>, <a href="#50620" title="B">elem</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50499" title="That">That</a><span class="delimiter">]</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50500">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50503">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50504">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="50711">index</a>: <span title="Int">Int</span>, <a title="B" id="50712">elem</a>: <a href="#50503" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50713">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50504" title="That">That</a> =
     <span class="delimiter">(</span><span class="delimiter">(</span><a href="#50711" title="Int">index</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="scales.utils.IATwo[B]" class="keyword">match</span> <span class="delimiter">{</span>
       <span class="keyword">case</span> <span title="scales.utils.IATwo[B]" class="int">0</span> =&gt; <a href="#63105" title="(one: B, two: B)scales.utils.IATwo[B]">IATwo</a><span class="delimiter">(</span><a href="#50712" title="B">elem</a>, <a href="#50512" title="=&gt; A">two</a><span class="delimiter">)</span>
       <span class="keyword">case</span> <span title="scales.utils.IATwo[B]" class="int">1</span> =&gt; <a href="#63105" title="(one: B, two: B)scales.utils.IATwo[B]">IATwo</a><span class="delimiter">(</span><a href="#50511" title="=&gt; A">one</a>, <a href="#50712" title="B">elem</a><span class="delimiter">)</span>
     <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50504" title="That">That</a><span class="delimiter">]</span>

<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class IAThree[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="63139">IAThree</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="50650">A</a> <span class="delimiter">]</span><a href="#63139" title="ScalaObject" class="delimiter">(</a> <a title="A" id="50675">one</a> : <a href="#50650" title="A">A</a>, <a title="A" id="50676">two</a> : <a href="#50650" title="A">A</a>, <a title="A" id="50677">three</a> : <a href="#50650" title="A">A</a> <span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(idx: Int)A" id="50661">apply</a><span class="delimiter">(</span><a title="Int" id="50797">idx</a> : <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#50797" title="Int">idx</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="A" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="IAThree.this.one.type" class="int">0</span> =&gt; <a href="#50675" title="=&gt; A">one</a>
    <span class="keyword">case</span> <span title="IAThree.this.two.type" class="int">1</span> =&gt; <a href="#50676" title="=&gt; A">two</a>
    <span class="keyword">case</span> <span title="IAThree.this.three.type" class="int">2</span> =&gt; <a href="#50677" title="=&gt; A">three</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="50662">length</a> = <span title="Int(3)" class="int">3</span>

  <span class="keyword">def</span> <a title="=&gt; scales.utils.IAThree[A]" id="50663">ar</a> = <a href="#63139" title="scales.utils.IAThree[A]" class="keyword">this</a>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="50664">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="50667">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="50668">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="50815">index</a>: <span title="Int">Int</span>, <a title="B" id="50816">elem</a>: <a href="#50667" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50817">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#50668" title="That">That</a> =
     <span class="delimiter">(</span><span class="delimiter">(</span><a href="#50815" title="Int">index</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="scales.utils.IAThree[B]" class="keyword">match</span> <span class="delimiter">{</span>
       <span class="keyword">case</span> <span title="scales.utils.IAThree[B]" class="int">0</span> =&gt; <a href="#63139" title="(one: B, two: B, three: B)scales.utils.IAThree[B]">IAThree</a><span class="delimiter">(</span><a href="#50816" title="B">elem</a>, <a href="#50676" title="=&gt; A">two</a>, <a href="#50677" title="=&gt; A">three</a><span class="delimiter">)</span>
       <span class="keyword">case</span> <span title="scales.utils.IAThree[B]" class="int">1</span> =&gt; <a href="#63139" title="(one: B, two: B, three: B)scales.utils.IAThree[B]">IAThree</a><span class="delimiter">(</span><a href="#50675" title="=&gt; A">one</a>, <a href="#50816" title="B">elem</a>, <a href="#50677" title="=&gt; A">three</a><span class="delimiter">)</span>
       <span class="keyword">case</span> <span title="scales.utils.IAThree[B]" class="int">2</span> =&gt; <a href="#63139" title="(one: B, two: B, three: B)scales.utils.IAThree[B]">IAThree</a><span class="delimiter">(</span><a href="#50675" title="=&gt; A">one</a>, <a href="#50676" title="=&gt; A">two</a>, <a href="#50816" title="B">elem</a><span class="delimiter">)</span>
     <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#50668" title="That">That</a><span class="delimiter">]</span>

<span class="delimiter">}</span>


<span class="comment">/**
 * Object arrays are just faster, System.arraycopy doesn't trust you and will type check everything, we can let nsc do that job for us.
 *
 * Same as ImmutableArray but for when the base is the entire collection, no offset or len are then needed
 */</span> 
<span class="keyword">trait</span> <a title="trait ImmutableArrayT[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject" id="10545">ImmutableArrayT</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="11864">A</a> <span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; Array[AnyRef]" id="48083">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="48084">offset</a> : <span title="Int">Int</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="48085">len</a> : <span title="Int">Int</span>

  <span class="keyword">import</span> <a href="#51603" title="object scales.utils.ImmutableArrayProxyBuilder">ImmutableArrayProxyBuilder</a>._

  <span class="keyword">def</span> <a title="(idx: Int)A" id="48087">apply</a><span class="delimiter">(</span><a title="Int" id="50945">idx</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#48083" title="(i: Int)AnyRef">base</a><span class="delimiter">(</span><a href="#50945" title="Int">idx</a> <span title="(x: Int)Int">+</span> <a href="#48084" title="=&gt; Int">offset</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11864" title="A">A</a><span class="delimiter">]</span>
 
  <span class="keyword">def</span> <a title="=&gt; Int" id="48088">length</a> = <a href="#48085" title="=&gt; Int">len</a>
  
  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="48089">+:</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="48092">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="48093">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="50964">elem</a>: <a href="#48092" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="50965">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#48093" title="That">That</a> =
    <span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#50922" title="=&gt; Int(31)">vectorAfter</a><span class="delimiter">)</span> <a href="#10545" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That">+:</span><a href="#50965" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" class="delimiter">(</a><a href="#50964" title="B">elem</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Array[AnyRef]" id="51019">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <a href="#51019" title="Array[AnyRef]">ar</a>, <span title="Int(1)" class="int">1</span>, <a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
      <a href="#51019" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <a href="#50964" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <a href="#63075" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#48092" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#51019" title="Array[AnyRef]">ar</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#48093" title="That">That</a><span class="delimiter">]</span>
  
  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="48094">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="48097">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="48098">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="51117">elem</a>: <a href="#48097" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="51118">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#48098" title="That">That</a> =
    <span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#50922" title="=&gt; Int(31)">vectorAfter</a><span class="delimiter">)</span> <a href="#10545" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That">:+</span><a href="#51118" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" class="delimiter">(</a><a href="#51117" title="B">elem</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Array[AnyRef]" id="51172">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <a href="#51172" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
      <a href="#51172" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span> = <a href="#51117" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <a href="#63075" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#48097" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#51172" title="Array[AnyRef]">ar</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#48098" title="That">That</a><span class="delimiter">]</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.ImmutableArray[Nothing]" id="48099">take</a><span class="delimiter">(</span> <a title="Int" id="51232">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = 
    <a href="#51541" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#51232" title="Int">n</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#48085" title="=&gt; Int">len</a> <span class="keyword">else</span> <a href="#51232" title="Int">n</a><span class="delimiter">)</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.ImmutableArray[Nothing]" id="48100">drop</a><span class="delimiter">(</span> <a title="Int" id="51244">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = 
    <a href="#51541" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a> <span title="(x: Int)Int">+</span> <a href="#51244" title="Int">n</a>, <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#51244" title="Int">n</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Int">-</span> <a href="#51244" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scales.utils.ImmutableArray[Nothing]" id="48101">tail</a> = <a href="#48100" title="(n: Int)scales.utils.ImmutableArray[Nothing]">drop</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="comment">/**
   * we can do better - slice used by many functions in Optimized
   */</span> 
  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(from: Int, until: Int)scales.utils.ImmutableArray[Nothing]" id="48102">slice</a><span class="delimiter">(</span><a title="Int" id="51267">from</a>: <span title="Int">Int</span>, <a title="Int" id="51268">until</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="51271">lo</a>    = <span title="object scala.math.package">math</span>.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#51267" title="Int">from</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="51272">hi</a>    = <span title="object scala.math.package">math</span>.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#51268" title="Int">until</a>, <a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="51273">elems</a> = <span title="object scala.math.package">math</span>.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#51272" title="Int">hi</a> <span title="(x: Int)Int">-</span> <a href="#51271" title="Int">lo</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#51541" title="(base: Array[AnyRef], offset: Int, len: Int)scales.utils.ImmutableArray[Nothing]">ImmutableArray</a><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <a href="#51273" title="Int">elems</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Basically optimised version for back, hint used directly, one new array creation
   */</span> 
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="48103">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="48106">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="48107">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="51303">index</a>: <span title="Int">Int</span>, <a title="B" id="51304">elem</a>: <a href="#48106" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="51305">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#48107" title="That">That</a> =
    <span title="That" class="keyword">if</span> <span class="delimiter">(</span><a href="#51305" title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">bf</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#51351" title="scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[_]">ImmutableArrayProxy</a>.ImmutableArrayProxyCBF<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// we know its objects underneath, we know the relationship is sound</span>
      <span class="keyword">val</span> <a title="Array[AnyRef]" id="51362">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[AnyRef])Array[AnyRef]" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.Manifest[java.lang.Object]" class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
      <span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <a href="#51362" title="Array[AnyRef]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
      <a href="#51362" title="(i: Int, x: AnyRef)Unit">ar</a><span class="delimiter">(</span><a href="#51303" title="Int">index</a><span class="delimiter">)</span> = <a href="#51304" title="B">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <a href="#63075" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[B]" class="delimiter">[</span><a href="#48106" title="B">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#51362" title="Array[AnyRef]">ar</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#48107" title="That">That</a><span class="delimiter">]</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Builder[B,That]" id="51375">b</a> = <a href="#51305" title="(from: scales.utils.ImmutableArrayProxy[A])scala.collection.mutable.Builder[B,That]">bf</a><span class="delimiter">(</span><a href="#10545" title="=&gt; scales.utils.ImmutableArrayProxy[A]">repr</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="#51377" title="(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A])" class="delimiter">(</a><a href="#51376" title="scales.utils.ImmutableArrayProxy[A]" id="51377">prefix</a>, <a href="#51376" title="scales.utils.ImmutableArrayProxy[A]" id="51378">rest</a><span class="delimiter">)</span> = <a href="#10545" title="ImmutableArrayT.this.type" class="keyword">this</a>.<span title="(n: Int)(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A])">splitAt</span><span title="(scales.utils.ImmutableArrayProxy[A], scales.utils.ImmutableArrayProxy[A]) @unchecked" class="delimiter">(</span><a href="#51303" title="Int">index</a><span class="delimiter">)</span>
      <a href="#51375" title="scala.collection.mutable.Builder[B,That]">b</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
      <a href="#51375" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(xs: scala.collection.TraversableOnce[B])b.type">++=</span> <a href="#10545" title="(repr: scales.utils.ImmutableArrayProxy[A])IndexedSeq[A]">toCollection</a><span class="delimiter">(</span><a href="#51377" title="scales.utils.ImmutableArrayProxy[A]">prefix</a><span class="delimiter">)</span>
      <a href="#51375" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(elem: B)b.type">+=</span> <a href="#51304" title="B">elem</a>
      <a href="#51375" title="scala.collection.mutable.Builder[B,That]">b</a> <span title="(xs: scala.collection.TraversableOnce[B])b.type">++=</span> <a href="#10545" title="(repr: scales.utils.ImmutableArrayProxy[A])IndexedSeq[A]">toCollection</a><span class="delimiter">(</span><a href="#51378" title="scales.utils.ImmutableArrayProxy[A]">rest</a>.<span title="=&gt; scales.utils.ImmutableArrayProxy[A]">tail</span><span class="delimiter">)</span>
      <a href="#51375" title="scala.collection.mutable.Builder[B,That]">b</a>.<span title="()That">result</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[U &gt;: A](implicit evidence$1: ClassManifest[U])Array[U]" id="51437">toArray</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="48110">U</a> &gt;: A : ClassManifest<span class="delimiter">]</span>: <span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span> =
    <span title="Array[U]" class="keyword">if</span> <span class="delimiter">(</span><span title="[T](implicit e: T)T">implicitly</span><a href="#51437" title="(implicit e: ClassManifest[U])ClassManifest[U]" class="delimiter">[</a><span title="ClassManifest[U]">ClassManifest</span><span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="=&gt; java.lang.Class[_]">erasure</span> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#48083" title="=&gt; Array[AnyRef]">base</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.Class[_]">getComponentType</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Array[U]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#48084" title="=&gt; Int">offset</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#48085" title="=&gt; Int">len</a> <span title="(x: Int)Boolean">==</span> <a href="#48083" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span><span class="delimiter">)</span>
	<a href="#48083" title="=&gt; Array[AnyRef]">base</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Array[U]" class="delimiter">[</span><span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
	<span class="keyword">val</span> <a title="Array[U]" id="51466">ar</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[U])Array[U]" class="delimiter">[</span><a href="#48110" title="U">U</a><span class="delimiter">]</span><a href="#51437" title="ClassManifest[U]" class="delimiter">(</a><a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
	<span title="object Array">Array</span>.<span title="(src: AnyRef, srcPos: Int, dest: AnyRef, destPos: Int, length: Int)Unit">copy</span><span class="delimiter">(</span><a href="#48083" title="=&gt; Array[AnyRef]">base</a>, <a href="#48084" title="=&gt; Int">offset</a>, <a href="#51466" title="Array[U]">ar</a>, <span title="Int(0)" class="int">0</span>, <a href="#48085" title="=&gt; Int">len</a><span class="delimiter">)</span>
	<a href="#51466" title="Array[U]">ar</a>	
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> 
      <a href="#10545" title="scales.utils.ImmutableArrayT[A]" class="keyword">super</a>.<span title="[B &gt;: A](implicit evidence$1: ClassManifest[B])Array[B]">toArray</span><a href="#51437" title="(implicit evidence$1: ClassManifest[U])Array[U]" class="delimiter">[</a><a href="#48110" title="U">U</a><span class="delimiter">]</span>


  <span class="keyword">def</span> <a title="=&gt; scales.utils.ImmutableArrayT[A]" id="48111">ar</a> = <a href="#10545" title="scales.utils.ImmutableArrayT[A]" class="keyword">this</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * Don't add the offset and length, for building a dom this save 8 per elem, only matters for large docs (can save 4mb from 54mb), but can't hurt small ones.
 */</span> 
case <span class="keyword">class</span> <a title="class ImmutableArrayAll[+A] extends java.lang.Object with scales.utils.ImmutableArrayT[A] with ScalaObject with Product with Serializable" id="63075">ImmutableArrayAll</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="51040">A</a> <span class="delimiter">]</span><a href="#63075" title="ScalaObject" class="delimiter">(</a> <a title="Array[AnyRef]" id="51054">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10545" title="scales.utils.ImmutableArrayT[A]">ImmutableArrayT</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="51045">offset</a> = <span title="Int(0)" class="int">0</span>
  @inline <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="51046">len</a> = <a href="#51054" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span>
  @inline <span class="keyword">final</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Int" id="51047">length</a> = <a href="#51054" title="=&gt; Array[AnyRef]">base</a>.<span title="=&gt; Int">length</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Object arrays are just faster, System.arraycopy doesn't trust you and will type check everything, we can let nsc do that job for us.
 */</span> 
case <span class="keyword">class</span> <a title="[A](x$0: scales.utils.ImmutableArray[A])Option[(Array[AnyRef], Int, Int)]" id="51541">ImmutableArray</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="51523">A</a> <span class="delimiter">]</span><a href="#51541" title="ScalaObject" class="delimiter">(</a> <a title="Array[AnyRef]" id="51521">base</a> : <span title="Array[AnyRef]">Array</span><span class="delimiter">[</span>AnyRef<span class="delimiter">]</span>, <a title="Int" id="51524">offset</a> : <span title="Int">Int</span>, <a title="Int" id="51527">len</a> : <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10545" title="scales.utils.ImmutableArrayT[A]">ImmutableArrayT</a><span class="delimiter">[</span>A<span class="delimiter">]</span>

<span class="comment">/**
 * Starts an ImmutableArrayProxy and provides the CanBuildFrom
 */</span> 
<span class="keyword">object</span> <a title="object scales.utils.ImmutableArrayProxy" id="10534">ImmutableArrayProxy</a> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.collection.generic.SeqFactory[scales.utils.ImmutableArrayProxy]">SeqFactory</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scales.utils.IAEmpty[Nothing]" id="51340">emptyImmutableArray</a> = <a href="#63170" title="[A]()scales.utils.IAEmpty[A]">IAEmpty</a><span title="()scales.utils.IAEmpty[Nothing]" class="delimiter">[</span><span title="Nothing">Nothing</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="comment">//new ImmutableArray[Nothing](Array[AnyRef](),0,0)</span>

  @inline <span class="keyword">final</span> <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A]=&gt; scales.utils.ImmutableArrayProxy[A]" id="51342">empty</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="51344">A</a> <span class="delimiter">]</span> : <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span>  = <a href="#51340" title="=&gt; scales.utils.IAEmpty[Nothing]">emptyImmutableArray</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scales.utils.ImmutableArrayProxy[A]" class="delimiter">[</span><a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>

  @inline <span class="keyword">def</span> <a title="[A]=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" id="51345">newBuilder</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="51347">A</a><span class="delimiter">]</span>
  : <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#62068" title="()scales.utils.ImmutableArrayProxyBuilder[A]">ImmutableArrayProxyBuilder</a><span class="delimiter">(</span><span class="delimiter">)</span>
  
  @inline <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[T](implicit ma: ClassManifest[T])scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]" id="51348">canBuildFrom</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="51350">T</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="ClassManifest[T]" id="51561">ma</a>: <span title="ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#51568" title="java.lang.Object with scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[T]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scales.utils.ImmutableArrayProxy.ImmutableArrayProxyCBF[T]" id="51568">ImmutableArrayProxyCBF</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">{</span> <span class="keyword">val</span> <a title="ClassManifest[T]" id="51572">m</a> = <a href="#51561" title="ClassManifest[T]">ma</a> <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait ImmutableArrayProxyCBF[T] extends java.lang.Object with scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]] with ScalaObject" id="51351">ImmutableArrayProxyCBF</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="51352">T</a><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[_],T,scales.utils.ImmutableArrayProxy[T]]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>_<span class="delimiter">]</span>, T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
    
    <span class="keyword">val</span> <a title="=&gt; ClassManifest[T]" id="51358">m</a> : <span title="ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(from: scales.utils.ImmutableArrayProxy[_])scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]" id="51359">apply</a><span class="delimiter">(</span><a title="scales.utils.ImmutableArrayProxy[_]" id="51585">from</a>: <a href="#10533" title="scales.utils.ImmutableArrayProxy[_]">ImmutableArrayProxy</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">Builder</span><span class="delimiter">[</span>T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#51345" title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">newBuilder</a>
    <span class="keyword">def</span> <a title="()scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]" id="51360">apply</a>: <span title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">Builder</span><span class="delimiter">[</span>T, ImmutableArrayProxy<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#51345" title="scala.collection.mutable.Builder[T,scales.utils.ImmutableArrayProxy[T]]">newBuilder</a>
  <span class="delimiter">}</span>
    
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scales.utils.ImmutableArrayProxyBuilder" id="51603">ImmutableArrayProxyBuilder</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(31)" id="50922">vectorAfter</a> = <span title="Int(31)" class="int">31</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Build array first then vector as needed
 */</span>
case <span class="keyword">class</span> <a title="Boolean(true)" id="62068">ImmutableArrayProxyBuilder</a><span class="delimiter">[</span> <a title="&gt;: Nothing &lt;: Any" id="11867">A</a> <span class="delimiter">]</span><a href="#62068" title="ScalaObject" class="delimiter">(</a><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#51603" title="object scales.utils.ImmutableArrayProxyBuilder">ImmutableArrayProxyBuilder</a>._

  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="scales.utils.ImmutableArrayBuilder[A]" id="50929">arrayBuilder</a> = <a href="#50041" title="scales.utils.ImmutableArrayBuilder[A]" class="keyword">new</a> <a href="#10516" title="scales.utils.ImmutableArrayBuilder[A]">ImmutableArrayBuilder</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" id="50930">vectorBuilder</a> : <span title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">Builder</span><span class="delimiter">[</span>A,scala.collection.immutable.Vector<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = _
  
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="50931">inVector</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="50932">haveChosen</a> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="comment">/**
   * Can the arrayBuilder be re-used?
   */</span> 
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Boolean" id="50933">canReuse</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="comment">// keep it locally</span>
  <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">var</span> <a title="Int" id="50934">length</a> = <span title="Int(0)" class="int">0</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(size: Int)Unit" id="50935">sizeHint</a><span class="delimiter">(</span> <a title="Int" id="51738">size</a> : <span title="Int">Int</span> <span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#51738" title="Int">size</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#50922" title="=&gt; Int(31)">vectorAfter</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50931" title="Boolean">inVector</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#50932" title="Boolean">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
	<a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="[A]=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">newBuilder</span><span title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#51738" title="Int">size</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48420" title="(size: Int)Unit">sizeHint</a><span class="delimiter">(</span><a href="#51738" title="Int">size</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// for the case when we were under 32 but are now over</span>
  @inline <span class="keyword">final</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="50936">checkVB</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50934" title="Int">length</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#50922" title="=&gt; Int(31)">vectorAfter</a><span class="delimiter">)</span> <span class="delimiter">{</span>
	<a href="#50937" title="()Unit">moveToVector</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="50937">moveToVector</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// copy over</span>
    <span class="keyword">val</span> <a title="scales.utils.ImmutableArray[A]" id="51768">r</a> = <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48421" title="()scales.utils.ImmutableArray[A]">result</a>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="[A]=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">newBuilder</span><span title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>
    <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(size: Int)Unit">sizeHint</span><span class="delimiter">(</span><a href="#51768" title="scales.utils.ImmutableArray[A]">r</a>.<a href="#51527" title="=&gt; Int">len</a><span class="delimiter">)</span>
    <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">++=</span><span class="delimiter">(</span><a href="#51768" title="scales.utils.ImmutableArray[A]">r</a><span class="delimiter">)</span>
    <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48424" title="()Unit">clear</a>
    <a href="#50931" title="Boolean">inVector</a> = <span title="Boolean(true)" class="keyword">true</span>
    <a href="#50932" title="Boolean">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()scales.utils.ImmutableArrayProxy[A]" id="50938">result</a> : <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> <a href="#63042" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="()scala.collection.immutable.Vector[A]">result</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span> <span class="comment">// do it here as this is the correct type</span>
      <span class="keyword">val</span> <a title="Array[AnyRef]" id="52011">buf</a> = <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48416" title="=&gt; Array[AnyRef]">buf</a>
      <span class="keyword">import</span> scala.annotation.switch	

      <span class="delimiter">(</span><a href="#50934" title="Int">length</a> : @<span title="Int @scala.annotation.switch">switch</span><span class="delimiter">)</span> <span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">match</span> <span class="delimiter">{</span>
	<span class="keyword">case</span> <span title="scales.utils.ImmutableArrayProxy[A]" class="int">0</span> =&gt;
	  <a href="#10534" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a>.<a href="#51340" title="=&gt; scales.utils.IAEmpty[Nothing]">emptyImmutableArray</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scales.utils.ImmutableArrayProxy[A]" class="delimiter">[</span><a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
	<span class="keyword">case</span> <span title="scales.utils.IAOne[A]" class="int">1</span> =&gt;
	  <a href="#63162" title="(one: A)scales.utils.IAOne[A]">IAOne</a><span class="delimiter">(</span><a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span>
	<span class="keyword">case</span> <span title="scales.utils.IATwo[A]" class="int">2</span> =&gt;
	  <a href="#63105" title="(one: A, two: A)scales.utils.IATwo[A]">IATwo</a><span class="delimiter">(</span><a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>, <a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span>
	<span class="keyword">case</span> <span title="scales.utils.IAThree[A]" class="int">3</span> =&gt;
	  <a href="#63139" title="(one: A, two: A, three: A)scales.utils.IAThree[A]">IAThree</a><span class="delimiter">(</span><a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>, <a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>, <a href="#52011" title="(i: Int)AnyRef">buf</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span>
	<span class="keyword">case</span> <span title="scales.utils.ImmutableArrayProxy[A]">_</span> =&gt; <span class="delimiter">{</span>
	  <a href="#50933" title="Boolean">canReuse</a> = <span title="Boolean(false)" class="keyword">false</span>
	  <span title="scales.utils.ImmutableArrayProxy[A]" class="keyword">if</span> <span class="delimiter">(</span><a href="#50934" title="Int">length</a> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#50934" title="Int">length</a> <span title="(x: Int)Boolean">==</span> <a href="#52011" title="Array[AnyRef]">buf</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>
	    <a href="#63075" title="[A](base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]">ImmutableArrayAll</a><span title="(base: Array[AnyRef])scales.utils.ImmutableArrayAll[A]" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#52011" title="Array[AnyRef]">buf</a><span class="delimiter">)</span>
	  <span class="keyword">else</span>
	    <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48421" title="()scales.utils.ImmutableArray[A]">result</a>
	<span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(xs: TraversableOnce[A])ImmutableArrayProxyBuilder.this.type" id="50939">++=</a><span class="delimiter">(</span><a title="TraversableOnce[A]" id="52039">xs</a>: <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <span class="comment">// if its already a vector don't start with arrays again</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#50932" title="Boolean">haveChosen</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#52039" title="TraversableOnce[A]">xs</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#63042" title="scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50931" title="Boolean">inVector</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#50932" title="Boolean">haveChosen</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
	<a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a> = <span title="=&gt; collection.immutable.Vector.type">Vector</span>.<span title="[A]=&gt; scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">newBuilder</span><span title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]" class="delimiter">[</span><a href="#11867" title="A">A</a><span class="delimiter">]</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <a href="#52039" title="TraversableOnce[A]">xs</a> <span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" id="52078">p</a> : <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; 
	<span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> 
	  <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">++=</span><span class="delimiter">(</span><a href="#52078" title="scales.utils.ImmutableArrayProxy[A]">p</a>.<a href="#48081" title="=&gt; TraversableOnce[A]">ar</a><span class="delimiter">)</span> 
	<span class="keyword">else</span>
	  <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48422" title="(xs: scala.collection.TraversableOnce[A])scales.utils.ImmutableArrayBuilder[A]">++=</a><span class="delimiter">(</span><a href="#52078" title="scales.utils.ImmutableArrayProxy[A]">p</a>.<a href="#48081" title="=&gt; TraversableOnce[A]">ar</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]">_</span> =&gt; 
	<span title="scala.collection.mutable.Builder[A,IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def take(n: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}; def tail: IndexedSeq[A] with Serializable{def drop(n: Int): IndexedSeq[A] with Serializable; def take(n: Int): IndexedSeq[A] with Serializable; def slice(from: Int,until: Int): IndexedSeq[A] with Serializable; def tail: IndexedSeq[A] with Serializable}}]" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span>
	  <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(xs: scala.collection.TraversableOnce[A])scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">++=</span><span class="delimiter">(</span><a href="#52039" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span>
	<span class="keyword">else</span>
	  <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48422" title="(xs: scala.collection.TraversableOnce[A])scales.utils.ImmutableArrayBuilder[A]">++=</a><span class="delimiter">(</span><a href="#52039" title="TraversableOnce[A]">xs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#50934" title="Int">length</a> <span title="(x: Int)Int">+=</span> <a href="#52039" title="TraversableOnce[A]">xs</a>.<span title="=&gt; Int">size</span>

    <a href="#50936" title="()Unit">checkVB</a>
    <a href="#62068" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(elem: A)ImmutableArrayProxyBuilder.this.type" id="50940">+=</a><span class="delimiter">(</span> <a title="A" id="62006">elem</a> : <a href="#11867" title="A">A</a><span class="delimiter">)</span> : <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#50934" title="Int">length</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
    <span title="ImmutableArrayProxyBuilder.this.type" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="(elem: A)scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">+=</span><span class="delimiter">(</span><a href="#62006" title="A">elem</a><span class="delimiter">)</span>
      <a href="#62068" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48423" title="(elem: A)scales.utils.ImmutableArrayBuilder[A]">+=</a><span class="delimiter">(</span><a href="#62006" title="A">elem</a><span class="delimiter">)</span>
      <a href="#50936" title="()Unit">checkVB</a>
      <a href="#62068" title="ImmutableArrayProxyBuilder.this.type" class="keyword">this</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="50941">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#50931" title="Boolean">inVector</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// a bit more expensive then resetting the len</span>
      <a href="#50930" title="scala.collection.mutable.Builder[A,scala.collection.immutable.Vector[A]]">vectorBuilder</a>.<span title="()Unit">clear</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#50933" title="Boolean">canReuse</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">// array was used but not a vector or IAXxxs</span>
      <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a> = <a href="#50041" title="scales.utils.ImmutableArrayBuilder[A]" class="keyword">new</a> <a href="#10516" title="scales.utils.ImmutableArrayBuilder[A]">ImmutableArrayBuilder</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#50929" title="scales.utils.ImmutableArrayBuilder[A]">arrayBuilder</a>.<a href="#48424" title="()Unit">clear</a>
    <span class="delimiter">}</span>
    <a href="#50931" title="Boolean">inVector</a> = <span title="Boolean(false)" class="keyword">false</span>
    <a href="#50932" title="Boolean">haveChosen</a> = <span title="Boolean(false)" class="keyword">false</span>
    <a href="#50933" title="Boolean">canReuse</a> = <span title="Boolean(true)" class="keyword">true</span>
    <a href="#50934" title="Int">length</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Wraps behaviour of ImmutableArray like objects, when the array is greater than 31 it will be swapped to Vector.
 *
 */</span> 
<span class="keyword">trait</span> <a title="trait ImmutableArrayProxy[+A] extends java.lang.Object with IndexedSeq[A] with scala.collection.IndexedSeqOptimized[A,scales.utils.ImmutableArrayProxy[A]] with scala.collection.generic.GenericTraversableTemplate[A,scales.utils.ImmutableArrayProxy] with ScalaObject" id="10533">ImmutableArrayProxy</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="11868">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <span title="IndexedSeq[A]">IndexedSeq</span><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.IndexedSeqOptimized[A,scales.utils.ImmutableArrayProxy[A]]">IndexedSeqOptimized</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> <span class="keyword">with</span> <span title="scala.collection.generic.GenericTraversableTemplate[A,scales.utils.ImmutableArrayProxy]">GenericTraversableTemplate</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">]</span> <span class="delimiter">{</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.generic.GenericCompanion[scales.utils.ImmutableArrayProxy]" id="48079">companion</a>: <span title="scala.collection.generic.GenericCompanion[scales.utils.ImmutableArrayProxy]">GenericCompanion</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">]</span> = <a href="#10534" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a>

  <span class="keyword">override</span> <span class="keyword">protected</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" id="48080">newBuilder</a>: <span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">Builder</span><span class="delimiter">[</span>A, ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#10534" title="object scales.utils.ImmutableArrayProxy">ImmutableArrayProxy</a>.<a href="#51345" title="[A]=&gt; scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]">newBuilder</a><span title="scala.collection.mutable.Builder[A,scales.utils.ImmutableArrayProxy[A]]" class="delimiter">[</span><a href="#11868" title="A">A</a><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; TraversableOnce[A]" id="48081">ar</a> : <span title="TraversableOnce[A]">TraversableOnce</span><span class="delimiter">[</span>A<span class="delimiter">]</span>
 
<span class="delimiter">}</span>

<span class="comment">/**
 * Proxy Vector.  When its in Vector it stays in Vector. 
 */</span> 
case <span class="keyword">class</span> <a title="class VectorImpl[+A] extends java.lang.Object with scales.utils.ImmutableArrayProxy[A] with ScalaObject with Product with Serializable" id="63042">VectorImpl</a><span class="delimiter">[</span> +<a title="&gt;: Nothing &lt;: Any" id="51788">A</a> <span class="delimiter">]</span><a href="#63042" title="ScalaObject" class="delimiter">(</a><a title="Vector[A]" id="51823">ar</a> : <span title="Vector[A]">Vector</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10533" title="scales.utils.ImmutableArrayProxy[A]">ImmutableArrayProxy</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(idx: Int)A" id="51793">apply</a><span class="delimiter">(</span><a title="Int" id="62083">idx</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(index: Int)A">apply</span><span class="delimiter">(</span><a href="#62083" title="Int">idx</a><span class="delimiter">)</span>
 
  <span class="keyword">def</span> <a title="=&gt; Int" id="51794">length</a> = <a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="=&gt; Int">length</span>
  
  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="51795">+:</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="51798">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="51799">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="62099">elem</a>: <a href="#51798" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="62100">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#51799" title="That">That</a> = <a href="#63042" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">+:</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#62099" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#51799" title="That">That</a><span class="delimiter">]</span>
  
  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="51800">:+</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="51803">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="51804">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="B" id="62678">elem</a>: <a href="#51803" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="62679">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#51804" title="That">That</a> = <a href="#63042" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">:+</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#62678" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#51804" title="That">That</a><span class="delimiter">]</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.VectorImpl[A]" id="51805">take</a><span class="delimiter">(</span> <a title="Int" id="62781">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#63042" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(n: Int)scala.collection.immutable.Vector[A]">take</span><span class="delimiter">(</span><a href="#62781" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(n: Int)scales.utils.VectorImpl[A]" id="51806">drop</a><span class="delimiter">(</span> <a title="Int" id="62804">n</a> : <span title="Int">Int</span> <span class="delimiter">)</span> = <a href="#63042" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(n: Int)scala.collection.immutable.Vector[A]">drop</span><span class="delimiter">(</span><a href="#62804" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; scales.utils.VectorImpl[A]" id="51807">tail</a> = <a href="#63042" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="=&gt; scala.collection.immutable.Vector[A]">tail</span><span class="delimiter">)</span>

  @inline <span class="keyword">override</span> <span class="keyword">def</span> <a title="(from: Int, until: Int)scales.utils.VectorImpl[A]" id="51808">slice</a><span class="delimiter">(</span><a title="Int" id="62838">from</a>: <span title="Int">Int</span>, <a title="Int" id="62839">until</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#63042" title="(ar: Vector[A])scales.utils.VectorImpl[A]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(from: Int, until: Int)scala.collection.immutable.Vector[A]">slice</span><span class="delimiter">(</span><a href="#62838" title="Int">from</a>, <a href="#62839" title="Int">until</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[B &gt;: A, That](index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That])That" id="51809">updated</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="51812">B</a> &gt;: A, <a title="&gt;: Nothing &lt;: Any" id="51813">That</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="62856">index</a>: <span title="Int">Int</span>, <a title="B" id="62857">elem</a>: <a href="#51812" title="B">B</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]" id="62858">bf</a>: <span title="scala.collection.generic.CanBuildFrom[scales.utils.ImmutableArrayProxy[A],B,That]">CanBuildFrom</span><span class="delimiter">[</span>ImmutableArrayProxy<span class="delimiter">[</span>A<span class="delimiter">]</span>, B, That<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#51813" title="That">That</a> = <a href="#63042" title="(ar: Vector[B])scales.utils.VectorImpl[B]">VectorImpl</a><span class="delimiter">(</span><a href="#51823" title="=&gt; Vector[A]">ar</a>.<span title="(index: Int, elem: B)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector[A],B,scala.collection.immutable.Vector[B]])scala.collection.immutable.Vector[B]">updated</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Vector.Coll,B,scala.collection.immutable.Vector[B]]" class="delimiter">(</span><a href="#62856" title="Int">index</a>, <a href="#62857" title="B">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="That" class="delimiter">[</span><a href="#51813" title="That">That</a><span class="delimiter">]</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[U &gt;: A](implicit evidence$2: ClassManifest[U])Array[U]" id="62972">toArray</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="51816">U</a> &gt;: A : ClassManifest<span class="delimiter">]</span>: <span title="Array[U]">Array</span><span class="delimiter">[</span>U<span class="delimiter">]</span> = <a href="#51823" title="=&gt; Vector[A]">ar</a>.<a href="#62972" title="(implicit evidence$1: ClassManifest[U])Array[U]">toArray</a>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>